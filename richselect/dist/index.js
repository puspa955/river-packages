"use strict";var e=require("react"),t=require("@ankamala/core"),o=require("react/jsx-runtime");const s=e=>"object"==typeof e?e.path:e,l=({selected:e,onRemove:l,onClearAll:r})=>{const a=e.slice().sort((e,t)=>{const o="object"==typeof e?e.label:e,s="object"==typeof t?t.label:t;return o.localeCompare(s)});return o.jsxs("div",{className:"relative flex items-center justify-between px-4 pt-2 pb-4 gap-2 border-b pr-8",children:[o.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(e=>o.jsxs("span",{onClick:t=>{t.stopPropagation(),l(e)},className:"flex items-center bg-primary-400/10 text-[10px] px-1 py-0.5 rounded-sm cursor-pointer hover:bg-gray-200 transition",children:["object"==typeof e?e.label:e,o.jsx(t.FAIcon,{icon:"close",className:"h-2 w-2 ml-1 text-primary-600"})]},s(e)))}),o.jsx("div",{onClick:e=>{e.stopPropagation(),r()},className:"absolute top-1 right-2 cursor-pointer",children:o.jsx(t.Tooltip,{tooltipText:"Clear all",icon:"close",className:"h-4 w-4 mr-1 text-gray-500 hover:text-gray-800 transition"})})]})},r=({options:e,selected:l,onOptionSelect:a,className:n,multiple:i,isSmall:c,optionTooltip:p})=>o.jsx("div",{className:t.cn(n),children:e.map((e,n)=>{if(e.isLoading)return o.jsx(t.CommandItem,{value:e.label,className:"px-4 py-2 text-sm text-gray-500 cursor-default",disabled:!0,children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(t.Spinner,{className:"w-4 h-4"}),o.jsx("span",{children:e.label})]})},"loading-state");const d=i||c?l.some(t=>s(t)===s(e)):l&&s(l)===s(e);if(e.options)return o.jsx(t.CommandGroup,{className:"px-2 mt-2 overflow-visible",heading:o.jsx("span",{className:"cursor-default font-bold text-sm text-gray-800 whitespace-nowrap",children:e.label}),children:o.jsx(r,{options:e.options,selected:l,onOptionSelect:a,multiple:i,isSmall:c,optionTooltip:p})},n);{const s=o.jsx(t.CommandItem,{value:e.label,className:t.cn("px-4 cursor-pointer hover:bg-gray-100 font-light border-b border-gray-100 whitespace-nowrap",d&&"bg-primary-400/10"),onSelect:()=>a(e),children:o.jsxs("div",{className:"flex justify-between items-center w-full gap-2",children:[o.jsx("span",{className:"whitespace-nowrap",children:e.label}),d&&o.jsx(t.FAIcon,{icon:"check",className:"text-primary-600 h-3 w-3 ml-2 flex-shrink-0"})]})},n);if(p){const l="function"==typeof p?p(e):null==p?void 0:p[e.path];return l?o.jsx(t.Tooltip,{tooltipText:l,side:"right",children:s},n):s}return s}})});exports.RichSelect=({options:a,selected:n=[],onSelect:i,trigger:c,children:p,className:d,multiple:m=!1,isSearchable:h=!0,isSmall:x=!1,isShadow:u=!0,showSelectedSummary:b=!0,onSearchChange:g,searchPlaceholder:j="Search...",shouldFilter:f=!0,optionTooltip:y,searchFields:v=["label"]})=>{const[w,C]=e.useState(!1),[N,S]=e.useState(""),T=f?((e,t)=>{if(!t)return e;const o=t.toLowerCase(),s=(e=>{const t=[],o=e=>{e.forEach(e=>{e.options?o(e.options):e.isLoading||t.push(e)})};return o(e),t})(e).filter(e=>v.some(t=>{var s;return null===(s=e[t])||void 0===s?void 0:s.toLowerCase().includes(o)})),l=new Set(s.map(e=>e.path)),r=e=>e.map(e=>{if(e.options){const o=((e,t)=>e.toLowerCase().includes(t.toLowerCase()))(e.label,t);if(o)return{...e,matchedGroup:!0};const s=r(e.options);return s.length>0?{...e,options:s,matchedGroup:!1}:null}return e.isLoading||l.has(e.path)?e:null}).filter(Boolean);return r(e)})(a,N):a,L=e=>{if(m){const t=n.some(t=>s(t)===s(e))?n.filter(t=>s(t)!==s(e)):[...n,e];i(t)}else i(e),C(!1)};return o.jsx("div",{className:t.cn("relative flex",d),children:o.jsxs(t.Popover,{open:w,onOpenChange:C,children:[o.jsx(t.PopoverTrigger,{asChild:!0,className:"flex items-center gap-1 text-gray-500 text-sm "+(x?"border-none px-1 text-xs py-0":"border-b px-2 py-1"),children:p||c(n)}),o.jsx(t.PopoverContent,{align:"start",sideOffset:4,className:t.cn("bg-white border w-auto",!u&&"shadow-none"),children:o.jsx(t.TooltipProvider,{children:o.jsxs(t.CommandLibrary,{shouldFilter:!1,children:[h&&o.jsx(t.CommandInput,{placeholder:j,className:"px-4 py-2 mb-2 border-b border-gray-300",onValueChange:e=>{S(e),g&&g(e)}}),o.jsxs(t.CommandList,{children:[m&&n.length>0&&("always"===b||!1!==b&&a.length>6)&&o.jsx(l,{selected:n,onRemove:L,onClearAll:()=>i([])}),o.jsx(r,{options:T,selected:n,onOptionSelect:L,multiple:m,isSmall:x,optionTooltip:y}),0===T.length&&o.jsx(t.CommandEmpty,{})]})]})})})]})})};
//# sourceMappingURL=index.js.map
