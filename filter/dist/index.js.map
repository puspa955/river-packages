{"version":3,"file":"index.js","sources":["../../core/dist/index.esm.js","../utils/filterUtils.js","../src/DatePicker.js","../src/RichSelect.js","../src/FilterItem.js","../src/FilterGroup.js","../src/Filter.js","../src/Filters.js","../src/FilterPopover.js"],"sourcesContent":["import*as e from\"react\";import{forwardRef as a}from\"react\";import{Slot as t}from\"@radix-ui/react-slot\";import{cva as r}from\"class-variance-authority\";import{clsx as s}from\"clsx\";import{twMerge as o}from\"tailwind-merge\";import{FontAwesomeIcon as i}from\"@fortawesome/react-fontawesome\";export{FontAwesomeIcon as FAIcon}from\"@fortawesome/react-fontawesome\";import{jsxs as n,jsx as d,Fragment as l}from\"react/jsx-runtime\";import*as c from\"@radix-ui/react-popover\";import{config as m,library as f}from\"@fortawesome/fontawesome-svg-core\";import{faCheck as p,faXmark as u,faFilter as h}from\"@fortawesome/free-solid-svg-icons\";import*as g from\"@radix-ui/react-select\";import*as y from\"@radix-ui/react-switch\";import*as x from\"@radix-ui/react-tooltip\";import{Command as b}from\"cmdk\";import{DayPicker as N}from\"react-day-picker\";function w(...e){return o(s(e))}const v=({className:e})=>d(i,{icon:\"spinner\",className:w(\"animate-spin text-primary-600\",e)}),k=a(({selected:e,leftIcon:a,rightIcon:t,className:r,iconClassName:s,placeholder:o,maxWidth:l=\"max-w-20\",...c},m)=>n(\"button\",{ref:m,className:w(\"flex items-center border-b pb-1 px-2 text-gray-500 text-sm font-light cursor-pointer min-w-0 overflow-hidden\",r),...c,children:[n(\"div\",{className:\"flex text-start items-center justify-center truncate min-w-0\",children:[a&&d(i,{icon:a,className:w(\"h-3 w-3 text-secondary-500 flex-shrink-0\",s)}),d(\"span\",{className:`truncate min-w-0 ${l} ${a?\"pl-1\":\"\"}`,children:e&&e.length?Array.isArray(e)?`${e.length} selected`:e.label:o})]}),t&&d(i,{icon:t,className:\"h-3 w-3 pl-1 flex-shrink-0\"})]}));k.displayName=\"SelectTrigger\";const R=(e,a,t,r,s,o)=>d(k,{selected:e,leftIcon:a,rightIcon:t,className:r,iconClassName:s,placeholder:o,maxWidth:\"flex-1\"}),_=r(\"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\",{variants:{variant:{default:\"bg-primary-700 text-primary-50 shadow hover:bg-primary-800\",danger:\"bg-red-700 text-red-50 shadow-sm hover:bg-red-800\",outline:\"border border-input shadow-sm hover:bg-gray-100\",secondary:\"bg-secondary-700 text-secondary-50 shadow-sm hover:bg-secondary-800\",ghost:\"hover:bg-primary-50\",link:\"text-primary-800 underline-offset-4 hover:underline\"},size:{default:\"h-9 px-4 py-2\",sm:\"h-8 rounded-md px-3 text-xs\",lg:\"h-10 rounded-md px-8\",icon:\"h-9 w-9\"}},defaultVariants:{variant:\"default\",size:\"default\"}}),I=a(({className:e,variant:a,size:r,asChild:s=!1,loading:o=!1,children:i,...c},m)=>{const f=s?t:\"button\",p=s?n(\"span\",{className:\"inline-flex items-center\",children:[o&&d(v,{className:\"mr-2 h-4 w-4 animate-spin text-current\"}),i]}):n(l,{children:[o&&d(v,{className:\"mr-2 h-4 w-4 animate-spin text-current\"}),i]});return d(f,{className:w(_({variant:a,size:r,className:e})),title:c.title,ref:m,disabled:c.disabled||o,...c,children:p})});I.displayName=\"Button\";const C=e.forwardRef(({className:e,type:a,...t},r)=>d(\"input\",{type:a,className:w(\"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 disabled:cursor-not-allowed disabled:opacity-50\",e),ref:r,...t}));C.displayName=\"Input\";const S=c.Root,z=c.Trigger,j=e.forwardRef(({className:e,align:a=\"center\",sideOffset:t=4,...r},s)=>d(c.Portal,{children:d(c.Content,{ref:s,align:a,sideOffset:t,className:w(\"bg-popover text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",e),...r})}));j.displayName=c.Content.displayName,m.autoAddCss=!1,f.add(p,u,h);const T=g.Root,D=g.Group,A=g.Value,B=e.forwardRef(({iconClassName:e,className:a,isIconShow:t=!0,children:r,...s},o)=>n(g.Trigger,{ref:o,className:w(\"flex h-9 w-full items-center whitespace-nowrap rounded-sm border bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",a),...s,children:[d(g.Icon,{asChild:!0,children:t&&d(i,{icon:\"sort\",className:w(\"mr-2 w-4 h-4\",e)})}),r]}));B.displayName=g.Trigger.displayName;const L=e.forwardRef(({className:e,...a},t)=>d(g.ScrollUpButton,{ref:t,className:w(\"flex justify-center items-center py-1 cursor-default\",e),...a,children:d(i,{icon:\"chevron-up\"})}));L.displayName=g.ScrollUpButton.displayName;const O=e.forwardRef(({className:e,...a},t)=>d(g.ScrollDownButton,{ref:t,className:w(\"flex justify-center items-center py-1 cursor-default\",e),...a,children:d(i,{icon:\"chevron-down\"})}));O.displayName=g.ScrollDownButton.displayName;const G=e.forwardRef(({className:e,children:a,position:t=\"popper\",...r},s)=>d(g.Portal,{children:n(g.Content,{ref:s,className:w(\"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-sm border bg-white text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\"popper\"===t&&\"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",e),position:t,...r,children:[d(L,{}),d(g.Viewport,{className:w(\"p-1\",\"popper\"===t&&\"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"),children:a}),d(O,{})]})}));G.displayName=g.Content.displayName;const P=e.forwardRef(({className:e,...a},t)=>d(g.Label,{ref:t,className:w(\"px-2 py-1.5 text-sm font-semibold opacity-70\",e),...a}));P.displayName=g.Label.displayName;const V=e.forwardRef(({className:e,children:a,...t},r)=>n(g.Item,{ref:r,className:w(\"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-slate-100 focus:text-primary-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",e),...t,children:[d(\"span\",{className:\"flex absolute right-2 justify-center items-center w-3.5 h-3.5\",children:d(g.ItemIndicator,{children:d(i,{icon:\"check\",className:\"w-4 h-4\"})})}),d(g.ItemText,{children:a})]}));V.displayName=g.Item.displayName;const $=e.forwardRef(({className:e,...a},t)=>d(g.Separator,{ref:t,className:w(\"-mx-1 my-1 h-px bg-muted\",e),...a}));$.displayName=g.Separator.displayName;const F=e.forwardRef(({className:e,thumbStyle:a,...t},r)=>d(y.Root,{className:w(\"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary-600 data-[state=unchecked]:bg-gray-400\",e),...t,ref:r,children:d(y.Thumb,{className:w(\"pointer-events-none block h-5 w-5 rounded-full bg-primary-300 shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\",a)})}));F.displayName=y.Root.displayName;const U=({icon:e,children:a,tooltipText:t,side:r=\"top\",className:s})=>n(x.Root,{delayDuration:0,children:[d(x.Trigger,{asChild:!0,children:n(\"span\",{children:[e&&d(i,{icon:e,className:s}),a]})}),n(x.Content,{side:r,className:\"bg-black text-white text-xs rounded px-2 py-1 shadow-md\",children:[t,d(x.Arrow,{className:\"fill-black\"})]})]}),W=x.Provider,E=b,q=e.forwardRef((e,a)=>{const{className:t,...r}=e;return d(b.List,{ref:a,className:w(\"max-h-[340px] overflow-y-auto overflow-x-hidden scroll-smooth scroll-padding\",t),...r})});q.displayName=b.List.displayName;const H=e.forwardRef((e,a)=>{const{className:t,...r}=e;return d(b.Input,{ref:a,className:w(\"flex h-10 w-full border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50\",t),...r})});H.displayName=b.Input.displayName;const J=e.forwardRef((e,a)=>{const{className:t,...r}=e;return d(b.Item,{ref:a,className:w(\"relative flex cursor-default select-none items-center px-2 py-1.5 text-sm outline-none transition-colors duration-200 \",t),...r})});J.displayName=b.Item.displayName;const K=e.forwardRef((e,a)=>{const{className:t,...r}=e;return d(b.Group,{ref:a,className:w(\"overflow-hidden text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-0 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",t),...r})});K.displayName=b.Group.displayName;const M=e.forwardRef((e,a)=>{const{className:t,...r}=e;return d(b.Separator,{ref:a,className:w(\"-mx-1 h-px bg-border\",t),...r})});M.displayName=b.Separator.displayName;const Q=({className:e,...a})=>d(\"span\",{className:w(\"ml-auto text-xs tracking-widest text-muted-foreground\",e),...a});Q.displayName=\"CommandShortcut\";const X=e.forwardRef(({className:e,...a},t)=>d(b.Dialog,{ref:t,className:w(\"fixed inset-0 z-50 flex items-start justify-center p-4 pt-[25vh] backdrop-blur-md\",e),...a,children:d(\"div\",{className:\"w-full max-w-md rounded-md bg-background shadow-lg\",children:a.children})}));X.displayName=b.Dialog.displayName;const Y=e.forwardRef(({className:e,...a},t)=>d(\"div\",{ref:t,className:w(\"flex items-center justify-center p-4 text-sm text-muted-foreground\",e),...a,children:\"No results found.\"}));function Z({className:e,classNames:a,showOutsideDays:t=!0,...r}){return d(N,{showOutsideDays:t,className:w(\"p-3\",e),classNames:{months:\"flex flex-col lg:flex-row space-y-16 sm:space-x-4 sm:space-y-0\",month:\"space-y-4\",caption:\"flex justify-center pt-1 relative items-center\",caption_label:\"text-xs font-medium\",nav:\"space-x-1 flex items-center\",nav_button:w(_({variant:\"outline\"}),\"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-200\"),nav_button_previous:\"absolute left-1\",nav_button_next:\"absolute right-1\",table:\"w-full border-collapse space-y-1\",head_row:\"flex\",head_cell:\"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]\",row:\"flex w-full mt-0\",cell:\"h-8 w-8 text-center text-sm p-2 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",day:w(_({variant:\"ghost\"}),\"h-8 w-8 hover:bg-primary-100 p-1 font-normal aria-selected:opacity-100\"),day_range_end:\"day-range-end\",day_selected:\"bg-primary-600 text-white hover:bg-primary-600 hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",day_today:\"bg-accent text-accent-foreground\",day_outside:\"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30\",day_disabled:\"text-muted-foreground opacity-50\",day_range_middle:\"aria-selected:bg-accent aria-selected:text-accent-foreground\",day_hidden:\"invisible\",...a},components:{IconLeft:({...e})=>d(i,{icon:\"chevron-left\",className:\"w-4 h-4\"}),IconRight:({...e})=>d(i,{icon:\"chevron-right\",className:\"w-4 h-4\"})},...r})}Y.displayName=\"CommandEmpty\",Z.displayName=\"Calendar\";export{I as Button,Z as Calendar,X as CommandDialog,Y as CommandEmpty,K as CommandGroup,H as CommandInput,J as CommandItem,E as CommandLibrary,q as CommandList,M as CommandSeparator,Q as CommandShortcut,C as Input,S as Popover,j as PopoverContent,z as PopoverTrigger,T as Select,G as SelectContent,D as SelectGroup,V as SelectItem,P as SelectLabel,O as SelectScrollDownButton,L as SelectScrollUpButton,$ as SelectSeparator,B as SelectTrigger,A as SelectValue,v as Spinner,F as Switch,U as Tooltip,W as TooltipProvider,w as cn,R as renderSelectTrigger};\n//# sourceMappingURL=index.esm.js.map\n","import dayjs from \"dayjs/esm\";\r\n\r\nexport const adjustValueType = (value, filterType) => {\r\n  switch (filterType) {\r\n    case \"number\":\r\n      return Number(value);\r\n    case \"date\":\r\n      return dayjs(value).isValid() ? new Date(value) : new Date();\r\n    case \"boolean\":\r\n      return Boolean(value);\r\n    case \"float\":\r\n      return parseFloat(value);\r\n    default:\r\n      return value;\r\n  }\r\n};\r\n\r\nexport const decodeFiltersFromUrl = (encoded, fieldMeta) => {\r\n  const parsed = JSON.parse(atob(encoded));\r\n  if (Array.isArray(parsed)) {\r\n    return parsed.map(filter => ({\r\n      ...filter,\r\n      value: fieldMeta.all.map[filter.key]?.type === 'date' ? new Date(filter.value) : filter.value,\r\n    }));\r\n  } else {\r\n    const process = (schema) => {\r\n      if (schema?.and) return { ...schema, and: schema.and.map(process) };\r\n      if (schema?.or) return { ...schema, or: schema.or.map(process) };\r\n      if (schema?.key && fieldMeta.all.map[schema.key]?.type === 'date') {\r\n        return { ...schema, value: new Date(schema.value) };\r\n      }\r\n      return schema;\r\n    };\r\n    return process(parsed);\r\n  }\r\n};\r\nexport const Fence = {\r\n  \"<\": (a, b) => a < b,\r\n  \">\": (a, b) => a > b,\r\n  \">=\": (a, b) => a >= b,\r\n  \"<=\": (a, b) => a <= b,\r\n  \"=\": (a, b) => {\r\n    if (Array.isArray(a) && Array.isArray(b)) return b.some(item => a.includes(item));\r\n    if (Array.isArray(a)) return a.includes(b);\r\n    if (Array.isArray(b)) return b.includes(a);\r\n    return a === b;\r\n  },\r\n  \"!=\": (a, b) => {\r\n    if (Array.isArray(a) && Array.isArray(b)) return !b.some(item => a.includes(item));\r\n    if (Array.isArray(a)) return !a.includes(b);\r\n    if (Array.isArray(b)) return !b.includes(a);\r\n    return a !== b;\r\n  },\r\n  contains: (a, b) => typeof a === \"string\" && typeof b === \"string\" ? a.toLowerCase().includes(b.toLowerCase()) : false,\r\n  beginswith: (a, b) => typeof a === \"string\" && typeof b === \"string\" ? a.toLowerCase().startsWith(b.toLowerCase()) : false,\r\n  process(a, b, operator) {\r\n    return this[operator](a, b);\r\n  },\r\n};\r\n\r\n// Function to evaluate a filter schema against an item\r\nexport function evaluateFilter(item, schema) {\r\n  if (!schema) return true;\r\n\r\n  if (schema.operator && Array.isArray(schema.rules) && schema.rules.length === 1) {\r\n    return evaluateFilter(item, schema.rules[0]);\r\n  }\r\n  // If schema is an array, treat as AND (legacy support)\r\n  if (Array.isArray(schema)) {\r\n    return schema.every(sub => evaluateFilter(item, sub));\r\n  }\r\n\r\n  // Handle group: AND/OR with rules array\r\n  if (schema.operator && Array.isArray(schema.rules)) {\r\n    const operator = schema.operator.toLowerCase();\r\n\r\n    if (operator === \"and\") {\r\n      return schema.rules.every(sub => evaluateFilter(item, sub));\r\n    }\r\n\r\n    if (operator === \"or\") {\r\n      return schema.rules.some(sub => evaluateFilter(item, sub));\r\n    }\r\n  }\r\n\r\n  // Handle single condition\r\n  if (schema.key && schema.operator && schema.value !== undefined) {\r\n    const { key, value, operator } = schema;\r\n\r\n    let itemValue = item[key];\r\n\r\n    // Handle undefined/null values\r\n    if (itemValue === undefined || itemValue === null) {\r\n      // For 'not equals' operations, null/undefined should return true\r\n      if (operator === '!=' || operator === 'not_equals') {\r\n        return value !== null && value !== undefined && value !== '';\r\n      }\r\n      // For other operations, null/undefined should return false\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      return Fence.process(itemValue, value, operator);\r\n    } catch (error) {\r\n      console.warn('Filter evaluation error:', error, { key, value, operator, itemValue });\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // If none of the above conditions match, return true (don't filter out)\r\n  return true;\r\n}\r\n\r\nexport function processDateFiltersInSchema(schema, fieldMeta) {\r\n  if (!schema) return schema;\r\n\r\n  // Helper to check if a field is a date type\r\n  const isDateField = (key) => {\r\n    if (!key || !fieldMeta?.all?.map) return false;\r\n    return fieldMeta.all.map[key]?.type === \"date\";\r\n  };\r\n\r\n  // Array of filters (AND by default)\r\n  if (Array.isArray(schema)) {\r\n    return schema.map((item) => processDateFiltersInSchema(item, fieldMeta));\r\n  }\r\n\r\n  // Handle UI schema: operator + rules\r\n  if (schema.operator && Array.isArray(schema.rules)) {\r\n    return {\r\n      ...schema,\r\n      rules: schema.rules.map((item) => processDateFiltersInSchema(item, fieldMeta)),\r\n    };\r\n  }\r\n\r\n  // Handle legacy AND/OR recursively\r\n  if (schema.and) {\r\n    return {\r\n      ...schema,\r\n      and: schema.and.map((item) => processDateFiltersInSchema(item, fieldMeta)),\r\n    };\r\n  }\r\n  if (schema.or) {\r\n    return {\r\n      ...schema,\r\n      or: schema.or.map((item) => processDateFiltersInSchema(item, fieldMeta)),\r\n    };\r\n  }\r\n\r\n  // Leaf node: process if date field\r\n  if (schema.key && isDateField(schema.key) && typeof schema.value === \"string\") {\r\n    return {\r\n      ...schema,\r\n      value: new Date(schema.value),\r\n    };\r\n  }\r\n\r\n  // Otherwise, return as is\r\n  return schema;\r\n}\r\n// Filter function to apply conditions on features\r\nexport const filter = (features, filters, fields, fieldMeta) => {\r\n  if (!filters) return Array.isArray(features) ? [...features] : [];\r\n  const processedFilters = processDateFiltersInSchema(filters, fieldMeta);\r\n  return features.filter((item) => {\r\n    const dataToEvaluate = fields && fields[item.id] ? fields[item.id] : item;\r\n    const result = evaluateFilter(dataToEvaluate, processedFilters);\r\n    return result;\r\n  });\r\n}\r\n// Function to count conditions in a filter schema\r\nexport function countConditions(node) {\r\n  if (!node) return 0;\r\n  // If it's an array, sum all\r\n  if (Array.isArray(node)) {\r\n    return node.reduce((sum, n) => sum + countConditions(n), 0);\r\n  }\r\n  // If it's a group (has rules), recurse\r\n  if (node.rules && Array.isArray(node.rules)) {\r\n    return countConditions(node.rules);\r\n  }\r\n  // If it's a condition (has key), count as 1\r\n  if (node.key) return 1;\r\n  return 0;\r\n}\r\n","\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport { format } from \"date-fns\";\r\nimport { Calendar, Popover, PopoverContent, PopoverTrigger, Button } from \"@ankamala/core\";\r\nimport { cn } from \"@ankamala/core\";\r\n\r\nexport function DatePicker({\r\n  placeholder = \"Enter a date\",\r\n  value,\r\n  onChange,\r\n  format: dateFormat = \"yyyy MMM dd\",\r\n  calendarClassName,\r\n  className, \r\n}) {\r\n  const formattedDate = value ? format(value, dateFormat) : \"\";\r\n\r\n  return (\r\n    <Popover>\r\n      <PopoverTrigger asChild>\r\n        <Button\r\n          variant={\"outline\"}\r\n          className={cn(\r\n            \"text-xs border-0 border-b-[1px] shadow-none p-1 justify-start text-left font-normal\",\r\n            !value && \"text-slate-500\",\r\n            className \r\n          )}\r\n        >\r\n          {value ? formattedDate : <span>{placeholder}</span>}\r\n        </Button>\r\n      </PopoverTrigger>\r\n      <PopoverContent className=\"p-0 w-auto\" align=\"start\">\r\n        <Calendar\r\n          className={cn(\"bg-gray-100\", calendarClassName)}\r\n          classNames={{\r\n            head_cell: \"h-8 w-8 text-sm font-medium\",\r\n            cell: \"h-8 w-8 text-slate-600\",\r\n          }}\r\n          mode=\"single\"\r\n          selected={value}\r\n          onSelect={(e) => {\r\n            onChange(e);\r\n          }}\r\n          initialFocus\r\n        />\r\n      </PopoverContent>\r\n    </Popover>\r\n  );\r\n}","// RichSelect.js\r\n\"use client\"\r\n\r\nimport { useState } from \"react\"; // <- no direct React import for library bundling\r\nimport { Popover, PopoverTrigger, PopoverContent } from \"@ankamala/core\";\r\nimport {\r\n  CommandLibrary,\r\n  CommandList,\r\n  CommandItem,\r\n  CommandGroup,\r\n  CommandInput,\r\n  CommandEmpty,\r\n} from \"@ankamala/core\";\r\nimport { cn, Spinner } from \"@ankamala/core\";\r\nimport { FAIcon } from \"@ankamala/core\";\r\nimport { Tooltip, TooltipProvider } from \"@ankamala/core\";\r\n\r\n// Helpers\r\nconst getOptionValue = (option) => (typeof option === \"object\" ? option.path : option);\r\n\r\nconst SelectedOptionsDisplay = ({ selected, onRemove, onClearAll }) => {\r\n  const sortedSelected = selected.slice().sort((a, b) => {\r\n    const labelA = typeof a === \"object\" ? a.label : a;\r\n    const labelB = typeof b === \"object\" ? b.label : b;\r\n    return labelA.localeCompare(labelB);\r\n  });\r\n\r\n  return (\r\n    <div className=\"relative flex items-center justify-between px-4 pt-2 pb-4 gap-2 border-b pr-8\">\r\n      <div className=\"flex flex-wrap gap-2\">\r\n        {sortedSelected.map((option) => (\r\n          <span\r\n            key={getOptionValue(option)}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              onRemove(option);\r\n            }}\r\n            className=\"flex items-center bg-primary-400/10 text-[10px] px-1 py-0.5 rounded-sm cursor-pointer hover:bg-gray-200 transition\"\r\n          >\r\n            {typeof option === \"object\" ? option.label : option}\r\n            <FAIcon icon=\"close\" className=\"h-2 w-2 ml-1 text-primary-600\" />\r\n          </span>\r\n        ))}\r\n      </div>\r\n      <div\r\n        onClick={(e) => {\r\n          e.stopPropagation();\r\n          onClearAll();\r\n        }}\r\n        className=\"absolute top-1 right-2 cursor-pointer\"\r\n      >\r\n        <Tooltip\r\n          tooltipText=\"Clear all\"\r\n          icon=\"close\"\r\n          className=\"h-4 w-4 mr-1 text-gray-500 hover:text-gray-800 transition\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst RecursiveOptions = ({ options, selected, onOptionSelect, className, multiple, isSmall, optionTooltip }) => {\r\n  const sortedOptions = options.slice().sort((a, b) => {\r\n    const labelA = a.label?.toLowerCase() ?? \"\";\r\n    const labelB = b.label?.toLowerCase() ?? \"\";\r\n    return labelA.localeCompare(labelB);\r\n  });\r\n  return (\r\n    <div className={cn(className)}>\r\n      {sortedOptions.map((option, index) => {\r\n        if (option.isLoading) {\r\n          return (\r\n            <CommandItem\r\n              key=\"loading-state\"\r\n              value={option.label}\r\n              className=\"px-4 py-2 text-sm text-gray-500 cursor-default\"\r\n              disabled\r\n            >\r\n              <div className=\"flex items-center gap-2\">\r\n                <Spinner className=\"w-4 h-4\" />\r\n                <span>{option.label}</span>\r\n              </div>\r\n            </CommandItem>\r\n          );\r\n        }\r\n\r\n        const isSelected =\r\n          multiple || isSmall\r\n            ? selected.some((item) => getOptionValue(item) === getOptionValue(option))\r\n            : selected && getOptionValue(selected) === getOptionValue(option);\r\n\r\n        if (option.options) {\r\n          return (\r\n            <CommandGroup\r\n              className=\"px-2 mt-2 overflow-visible\"\r\n              key={index}\r\n              heading={<span className=\"cursor-default font-bold text-sm text-gray-800 whitespace-nowrap\">{option.label}</span>}\r\n            >\r\n              <RecursiveOptions\r\n                options={option.options}\r\n                selected={selected}\r\n                onOptionSelect={onOptionSelect}\r\n                multiple={multiple}\r\n                isSmall={isSmall}\r\n                optionTooltip={optionTooltip}\r\n              />\r\n            </CommandGroup>\r\n          );\r\n        } else {\r\n          const content = (\r\n            <CommandItem\r\n              key={index}\r\n              value={option.label}\r\n              className={cn(\r\n                \"px-4 cursor-pointer hover:bg-gray-100 font-light border-b border-gray-100 whitespace-nowrap\",\r\n                isSelected && \"bg-primary-400/10\"\r\n              )}\r\n              onSelect={() => onOptionSelect(option)}\r\n            >\r\n              <div className=\"flex justify-between items-center w-full gap-2\">\r\n                <span className=\"whitespace-nowrap\">{option.label}</span>\r\n                {isSelected && <FAIcon icon=\"check\" className=\"text-primary-600 h-3 w-3 ml-2 flex-shrink-0\" />}\r\n              </div>\r\n            </CommandItem>\r\n          );\r\n\r\n          if (optionTooltip) {\r\n            const tooltipText =\r\n              typeof optionTooltip === \"function\" ? optionTooltip(option) : optionTooltip?.[option.path];\r\n\r\n            return tooltipText ? (\r\n              <Tooltip key={index} tooltipText={tooltipText} side=\"right\">\r\n                {content}\r\n              </Tooltip>\r\n            ) : (\r\n              content\r\n            );\r\n          }\r\n\r\n          return content;\r\n        }\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst RichSelect = ({\r\n  options,\r\n  selected = [],\r\n  onSelect,\r\n  trigger,\r\n  children,\r\n  className,\r\n  multiple = false,\r\n  isSearchable = true,\r\n  isSmall = false,\r\n  isShadow = true,\r\n  showSelectedSummary = true,\r\n  onSearchChange,\r\n  searchPlaceholder = \"Search...\",\r\n  shouldFilter = true,\r\n  optionTooltip,\r\n  searchFields = ['label'],\r\n}) => {\r\n  const [openMain, setOpenMain] = useState(false);\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n\r\n  const flattenOptions = (opts) => {\r\n    const flattened = [];\r\n    const traverse = (items) => {\r\n      items.forEach(item => {\r\n        if (item.options) traverse(item.options);\r\n        else if (!item.isLoading) flattened.push(item);\r\n      });\r\n    };\r\n    traverse(opts);\r\n    return flattened;\r\n  };\r\n\r\n  const groupMatchesSearch = (groupLabel, search) => groupLabel.toLowerCase().includes(search.toLowerCase());\r\n\r\n  const filterOptions = (opts, search) => {\r\n    if (!search) return opts;\r\n    const searchLower = search.toLowerCase();\r\n    const flatMatches = flattenOptions(opts).filter(opt =>\r\n      searchFields.some(field => opt[field]?.toLowerCase().includes(searchLower))\r\n    );\r\n    const matchPaths = new Set(flatMatches.map(opt => opt.path));\r\n\r\n    const filterRecursive = (items) =>\r\n      items.map(item => {\r\n        if (item.options) {\r\n          const groupMatches = groupMatchesSearch(item.label, search);\r\n          if (groupMatches) return { ...item, matchedGroup: true };\r\n          const filteredChildren = filterRecursive(item.options);\r\n          if (filteredChildren.length > 0) return { ...item, options: filteredChildren, matchedGroup: false };\r\n          return null;\r\n        } else if (item.isLoading || matchPaths.has(item.path)) return item;\r\n        return null;\r\n      }).filter(Boolean);\r\n\r\n    return filterRecursive(opts);\r\n  };\r\n\r\n  const filteredOptions = shouldFilter ? filterOptions(options, searchValue) : options;\r\n\r\n  const handleOptionSelect = (option) => {\r\n    if (multiple) {\r\n      const isSelected = selected.some((item) => getOptionValue(item) === getOptionValue(option));\r\n      const newSelected = isSelected\r\n        ? selected.filter((item) => getOptionValue(item) !== getOptionValue(option))\r\n        : [...selected, option];\r\n      onSelect(newSelected);\r\n    } else {\r\n      onSelect(option);\r\n      setOpenMain(false);\r\n    }\r\n  };\r\n\r\n  const handleSearchChange = (value) => {\r\n    setSearchValue(value);\r\n    if (onSearchChange) onSearchChange(value);\r\n  };\r\n\r\n  return (\r\n    <div className={cn(\"relative flex\", className)}>\r\n      <Popover open={openMain} onOpenChange={setOpenMain}>\r\n        <PopoverTrigger\r\n          asChild\r\n          className={`flex items-center gap-1 text-gray-500 text-sm ${\r\n            isSmall ? \"border-none px-1 text-xs py-0\" : \"border-b px-2 py-1\"\r\n          }`}\r\n        >\r\n          {children ? children : trigger(selected)}\r\n        </PopoverTrigger>\r\n        <PopoverContent align=\"start\" sideOffset={4} className={cn(\"bg-white border w-auto\", !isShadow && \"shadow-none\")}>\r\n              <TooltipProvider>\r\n\r\n          <CommandLibrary shouldFilter={false}>\r\n            {isSearchable && (\r\n              <CommandInput\r\n                placeholder={searchPlaceholder}\r\n                className=\"px-4 py-2 mb-2 border-b border-gray-300\"\r\n                onValueChange={handleSearchChange}\r\n              />\r\n            )}\r\n\r\n            <CommandList>\r\n              {multiple && selected.length > 0 &&\r\n                (showSelectedSummary === \"always\" || (showSelectedSummary !== false && options.length > 6)) && (\r\n                  <SelectedOptionsDisplay\r\n                    selected={selected}\r\n                    onRemove={handleOptionSelect}\r\n                    onClearAll={() => onSelect([])}\r\n                  />\r\n                )}\r\n\r\n              <RecursiveOptions\r\n                options={filteredOptions}\r\n                selected={selected}\r\n                onOptionSelect={handleOptionSelect}\r\n                multiple={multiple}\r\n                isSmall={isSmall}\r\n                optionTooltip={optionTooltip}\r\n              />\r\n\r\n              {filteredOptions.length === 0 && <CommandEmpty />}\r\n            </CommandList>\r\n          </CommandLibrary>\r\n              </TooltipProvider>\r\n\r\n        </PopoverContent>\r\n      </Popover>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RichSelect;\r\n","import React, { useMemo } from \"react\";\r\nimport { Tooltip, Switch, Select, SelectTrigger, SelectValue, SelectContent, SelectItem, SelectGroup, SelectLabel, FAIcon, Input, renderSelectTrigger } from \"@ankamala/core\";\r\nimport { adjustValueType } from \"../utils/filterUtils\";\r\nimport { DatePicker } from \"./DatePicker\";\r\nimport RichSelect from \"./RichSelect\";\r\n\r\n\r\nconst operatorMap = {\r\n  number: [\"<\", \">\", \"<=\", \">=\"],\r\n  string: [\"contains\", \"beginswith\"],\r\n  date: [\"<\", \">\", \"<=\", \">=\"],\r\n  boolean: [],\r\n  select: [],\r\n  __all__: [\"=\", \"!=\"],\r\n};\r\n\r\nconst inputTypes = {\r\n  number: \"number\",\r\n  string: \"text\",\r\n  date: \"date\",\r\n};\r\n\r\nconst FilterItem = ({\r\n  removeFilter,\r\n  filter,\r\n  keys,\r\n  types,\r\n  handleFilterChange,\r\n  options,\r\n  keysMeta,\r\n}) => {\r\n  const { key, id, operator, value } = filter;\r\n\r\n  const filterType = useMemo(() => key && types[key], [key, types]);\r\n\r\n  const operators = useMemo(() => {\r\n    return filterType\r\n      ? [...operatorMap[\"__all__\"], ...operatorMap[filterType]]\r\n      : operatorMap[\"__all__\"];\r\n  }, [filterType]);\r\n\r\n  const inputType = useMemo(\r\n    () => inputTypes[filterType] || \"text\",\r\n    [filterType]\r\n  );\r\n\r\n  const optionsArray = useMemo(() => {\r\n    if (filterType === \"select\" && options?.[key]?.length) {\r\n      return options[key];\r\n    }\r\n    return [];\r\n  }, [filterType, options, key]);\r\n\r\n  const dateValue = useMemo(() => {\r\n    if (filterType === \"date\" && value) {\r\n      return adjustValueType(value, \"date\");\r\n    }\r\n    return null;\r\n  }, [filterType, value]);\r\n\r\n  const handleSelectChange = (field, value) => {\r\n    let newProperties;\r\n    if (field === \"key\") {\r\n      newProperties = {\r\n        [field]: value,\r\n        operator: \"=\",\r\n        value: adjustValueType(\"\", types[value]),\r\n      };\r\n    } else {\r\n      newProperties = { [field]: value };\r\n    }\r\n    handleFilterChange(id, newProperties);\r\n  };\r\n\r\n  return (\r\n  <div className=\"flex gap-2 items-center w-full\">\r\n    {/* Key, Operator, Value row */}\r\n    <div className=\"flex gap-4 items-center w-full\">\r\n      {/* Key */}\r\n      <div className=\"flex-shrink-0 w-[200px]\">\r\n        <RichSelect\r\n          selected={key}\r\n          onSelect={(v) => handleSelectChange(\"key\", v.path)}\r\n          options={keys}\r\n        >\r\n          <button className=\"border-b-[1px] pl-2 text-sm focus:ring-0 flex items-center w-full h-9\">\r\n            <FAIcon icon=\"sort\" className=\"h-3 w-3\" />\r\n            <span className=\"truncate\">{keysMeta[key]?.label}</span>\r\n          </button>\r\n        </RichSelect>\r\n      </div>\r\n\r\n      {/* Operator */}\r\n      <div className=\"flex-shrink-0 w-[75px]\">\r\n        <Select\r\n          onValueChange={(newValue) => handleSelectChange(\"operator\", newValue)}\r\n          value={operator}\r\n        >\r\n          <SelectTrigger\r\n            iconClassName=\"h-3 w-3 text-gray-500\"\r\n            className=\"border-0 border-b-[1px] shadow-none focus:ring-0 text-sm pl-0 text-gray-600 w-full\"\r\n          >\r\n            <SelectValue\r\n              className=\"text-slate-700 truncate\"\r\n              placeholder=\"Select\"\r\n            />\r\n          </SelectTrigger>\r\n          <SelectContent className=\"text-slate-700\">\r\n            {operators.map((item) => (\r\n              <SelectItem key={item} value={item}>\r\n                {item}\r\n              </SelectItem>\r\n            ))}\r\n          </SelectContent>\r\n        </Select>\r\n      </div>\r\n\r\n      {/* Value */}\r\n      <div className=\"flex-1\">\r\n        {filterType === \"select\" && (\r\n          <RichSelect\r\n            options={optionsArray}\r\n            selected={\r\n              keysMeta[key].multiple\r\n                ? (Array.isArray(value)\r\n                  ? value.map(val => optionsArray.find(opt => opt.path === val) || val)\r\n                  : [])\r\n                : optionsArray.find(opt => opt.path === value) || value\r\n            }\r\n            onSelect={(newValue) => {\r\n              const extracted = Array.isArray(newValue)\r\n                ? newValue.map(item => item.path ?? item)\r\n                : newValue.path ?? newValue;\r\n              handleSelectChange(\"value\", extracted);\r\n            }}\r\n            multiple={keysMeta[key].multiple ?? false}\r\n            isSearchable={true}\r\n            isSmall={false}\r\n            showSelectedSummary={false}\r\n            trigger={(selected) =>\r\n              renderSelectTrigger(\r\n                selected,\r\n                \"sort\",\r\n                null,\r\n                \"border-b-[1px] pl-2 text-sm focus:ring-0 flex items-center w-full h-9\",\r\n                \"mr-2\",\r\n                keysMeta[key].multiple\r\n                  ? \"Select\"\r\n                  : optionsArray.find(opt => opt.path === value)?.label || \"Select\"\r\n              )\r\n            }\r\n          />\r\n        )}\r\n\r\n        {filterType === \"date\" && (\r\n          <DatePicker\r\n            key=\"date\"\r\n            placeholder=\"Enter a date\"\r\n            value={dateValue}\r\n            format={\"yyyy MMM dd\"}\r\n            onChange={(date) => handleSelectChange(\"value\", date)}\r\n            className=\"w-full text-sm\"\r\n            calendarClassName=\"border-t-2 border-primary-600\"\r\n          />\r\n        )}\r\n\r\n        {filterType === \"boolean\" && (\r\n          <div className=\"flex justify-center items-center h-full text-center\">\r\n            <Tooltip tooltipText=\"Toggle to enable or disable\" className=\"mr-2 text-gray-500\">\r\n              <Switch\r\n                onCheckedChange={(e) => handleSelectChange(\"value\", !!e)}\r\n                checked={!!value}\r\n                 className=\"w-10 h-4.5 rounded-full border-transparent transition-colors data-[state=checked]:bg-primary-700 data-[state=unchecked]:bg-gray-500\"\r\n                 thumbStyle=\"w-4 h-4 bg-white rounded-full shadow-md transform transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\r\n              />\r\n            </Tooltip>\r\n          </div>\r\n        )}\r\n\r\n        {(filterType === \"string\" || filterType === \"number\") && (\r\n          <Input\r\n            defaultValue={value}\r\n            placeholder=\"Enter a value\"\r\n            onBlur={(e) =>\r\n              handleSelectChange(\"value\", adjustValueType(e?.target?.value, filterType))\r\n            }\r\n            type={inputType}\r\n            className=\"pl-2 bg-transparent text-sm rounded-none border-t-0 border-r-0 border-b-[1px] border-l-0 focus:ring-2 focus:ring-primary-500 focus:border-transparent h-9 w-full\"\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n\r\n    {/* Remove button */}\r\n    <Tooltip tooltipText=\"Remove item\">\r\n      <div onClick={() => removeFilter(id)} className=\"cursor-pointer\">\r\n        <FAIcon icon={\"multiply\"} />\r\n      </div>\r\n    </Tooltip>\r\n  </div>\r\n);\r\n\r\n};\r\n\r\nexport default FilterItem;","import React from \"react\";\r\nimport FilterItem from \"./FilterItem\";\r\nimport { FAIcon, Tooltip } from \"@ankamala/core\";\r\nimport { \r\n  Select,\r\n  SelectTrigger,\r\n  SelectValue,\r\n  SelectContent,\r\n  SelectItem\r\n} from \"@ankamala/core\";\r\nimport { cn } from \"@ankamala/core\";\r\n\r\n// Constants\r\nconst MAX_NESTING_LEVEL = 2;\r\n\r\n// Utility functions\r\nconst generateId = () => crypto?.randomUUID();\r\n\r\nconst createCondition = (overrides = {}, defaultCondition) => ({\r\n  id: generateId(),\r\n  ...defaultCondition,\r\n  ...overrides,\r\n  isGroup: false,\r\n});\r\n\r\nconst createGroup = (children = [], operator = \"and\") => ({\r\n  id: generateId(),\r\n  isGroup: true,\r\n  operator: operator.toLowerCase(), \r\n  rules: children, \r\n});\r\n\r\nexport { createCondition, createGroup }; \r\n\r\n// Subcomponents\r\nconst AddButtons = ({ onAddCondition, onAddGroup, canAddGroup = true, level = 0 }) => {\r\n  const isMaxLevel = level >= MAX_NESTING_LEVEL;\r\n  const baseButtonClass = \"text-gray-600 font-medium cursor-pointer hover:text-primary-600 text-sm\";\r\n  const disabledButtonClass = \"text-gray-400 text-sm cursor-not-allowed\";\r\n\r\n  return (\r\n    <div className=\"flex gap-4\">\r\n      <span className={baseButtonClass} onClick={onAddCondition}>\r\n        + Add condition\r\n      </span>\r\n      {canAddGroup && (\r\n        isMaxLevel ? (\r\n          <Tooltip tooltipText=\"Filter condition can only be nested three level deep\">\r\n            <span className={disabledButtonClass}>+ Add condition group</span>\r\n          </Tooltip>\r\n        ) : (\r\n          <span className={baseButtonClass} onClick={onAddGroup}>\r\n            + Add condition group\r\n          </span>\r\n        )\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst LogicSelector = ({ value, onChange }) => (\r\n  <Select defaultValue={value.toUpperCase()} onValueChange={(val) => onChange(val.toLowerCase())}>\r\n    <SelectTrigger\r\n      iconClassName=\"h-3 w-3 text-gray-500\"\r\n      className=\"border-0 border-b-[1px] shadow-none focus:ring-0 text-sm pl-0 text-gray-600 w-[55px]\"\r\n    >\r\n      <SelectValue />\r\n    </SelectTrigger>\r\n    <SelectContent>\r\n      <SelectItem value=\"AND\">and</SelectItem>\r\n      <SelectItem value=\"OR\">or</SelectItem>\r\n    </SelectContent>\r\n  </Select>\r\n);\r\n\r\nconst FilterGroup = ({\r\n  group,\r\n  onChange,\r\n  onRemove,\r\n  keys,\r\n  types,\r\n  options,\r\n  defaultCondition,\r\n  keysMeta,\r\n  level = 0,\r\n  isRoot = false,\r\n}) => {\r\n  const children = group.rules || [];\r\n  const logic = group.operator || group.logic || \"and\";\r\n\r\n  const updateChild = (id, updated) => {\r\n    const updatedChildren = children.map((child) => (child.id === id ? updated : child));\r\n    onChange({\r\n      ...group,\r\n      rules: updatedChildren,\r\n    });\r\n  };\r\n\r\n  const removeChild = (id) => {\r\n    const filteredChildren = children.filter((child) => child.id !== id);\r\n    onChange({\r\n      ...group,\r\n      rules: filteredChildren,\r\n    });\r\n  };\r\n\r\n  const addToGroup = (item) => {\r\n    onChange({\r\n      ...group,\r\n      rules: [...children, item],\r\n    });\r\n  };\r\n\r\n  const updateLogic = (newLogic) => {\r\n    onChange({\r\n       ...group,\r\n       operator: newLogic.toLowerCase(),\r\n    });\r\n  };\r\n\r\n  const handleAddCondition = () => addToGroup(createCondition({}, defaultCondition));\r\n  const handleAddGroup = () => addToGroup(createGroup());\r\n\r\n  const showGroupStyling = !isRoot;\r\n  const showGroupControls = !isRoot;\r\n  const isEmpty = children.length === 0;\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        \"flex flex-col gap-4\",\r\n        showGroupStyling && \"rounded-sm py-2 px-4 border bg-gray-100\"\r\n      )}\r\n    >\r\n      {isEmpty && showGroupControls && (\r\n        <div className=\"text-sm font-light\">Add conditions or sub-groups.</div>\r\n      )}\r\n\r\n      {children.map((child, index) => (\r\n        <div key={child.id} className=\"flex gap-2 items-start\">\r\n          {index === 0 ? (\r\n            <span className=\"w-[55px] pt-2 text-sm font-medium text-gray-700\">Where</span>\r\n          ) : index === 1 ? (\r\n            <LogicSelector value={logic} onChange={updateLogic} />\r\n          ) : (\r\n            <span className=\"w-[55px] pt-2 text-sm text-gray-700\">\r\n              {logic}\r\n            </span>\r\n          )}\r\n          <div className=\"flex-1\">\r\n            {child.isGroup ? (\r\n              <FilterGroup\r\n                group={child}\r\n                onChange={(updated) => updateChild(child.id, updated)}\r\n                onRemove={() => removeChild(child.id)}\r\n                keys={keys}\r\n                types={types}\r\n                options={options}\r\n                defaultCondition={defaultCondition}\r\n                keysMeta={keysMeta}\r\n                level={level + 1}\r\n                isRoot={false}\r\n              />\r\n            ) : (\r\n              <FilterItem\r\n                filter={child}\r\n                handleFilterChange={(id, props) =>\r\n                  updateChild(child.id, { ...child, ...props })\r\n                }\r\n                removeFilter={() => removeChild(child.id)}\r\n                types={types}\r\n                keys={keys}\r\n                options={options}\r\n                keysMeta={keysMeta}\r\n              />\r\n            )}\r\n          </div>\r\n        </div>\r\n      ))}\r\n\r\n      {showGroupControls && (\r\n        <div className=\"flex justify-between gap-10 items-center pt-2 border-t border-gray-200\">\r\n          <AddButtons\r\n            onAddCondition={handleAddCondition}\r\n            onAddGroup={handleAddGroup}\r\n            level={level}\r\n          />\r\n          <Tooltip tooltipText=\"Remove group\">\r\n            <button\r\n              onClick={onRemove}\r\n              className=\"text-gray-600 hover:text-gray-900 transition-colors\"\r\n            >\r\n              <FAIcon icon=\"multiply\" />\r\n            </button>\r\n          </Tooltip>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FilterGroup;","import React, { useState, useEffect } from \"react\";\r\nimport FilterGroup, { createCondition, createGroup } from \"./FilterGroup\";\r\nimport { FAIcon, Button } from \"@ankamala/core\"; \r\n\r\n\r\nconst AddButtons = ({ onAddCondition, onAddGroup }) => (\r\n  <div className=\"flex gap-6\">\r\n    <span\r\n      className=\"text-gray-600 font-medium cursor-pointer hover:text-primary-600 text-sm\"\r\n      onClick={onAddCondition}\r\n    >\r\n      + Add condition\r\n    </span>\r\n    <span\r\n      className=\"text-gray-600 font-medium cursor-pointer hover:text-primary-600 text-sm\"\r\n      onClick={onAddGroup}\r\n    >\r\n      + Add condition group\r\n    </span>\r\n  </div>\r\n);\r\n\r\n// Helper function to clean up the filter structure for backend\r\nconst cleanFilterForBackend = (group) => {\r\n  if (!group) return null;\r\n\r\n  if (!group.isGroup) {\r\n    const { id, isGroup, ...condition } = group;\r\n    if (!condition.key || !condition.operator) return null;\r\n    return condition;\r\n  }\r\n\r\n  const rules = (group.rules || [])\r\n    .map(child => cleanFilterForBackend(child))\r\n    .filter(Boolean);\r\n\r\n  if (rules.length === 0) return null;\r\n\r\n  return {\r\n    operator: group.operator || \"and\",\r\n    rules: rules,\r\n  };\r\n};\r\n\r\n// Backend to UI format\r\nconst convertBackendToUIFilter = (backendGroup) => {\r\n  if (!backendGroup) return null;\r\n\r\n  if (backendGroup.operator && Array.isArray(backendGroup.rules)) {\r\n    return {\r\n      id: crypto?.randomUUID(),\r\n      isGroup: true,\r\n      operator: backendGroup.operator,\r\n      rules: backendGroup.rules.map(rule => {\r\n        if (rule.operator && rule.rules) {\r\n          return convertBackendToUIFilter(rule);\r\n        } else {\r\n          return {\r\n            id: crypto?.randomUUID(),\r\n            isGroup: false,\r\n            ...rule\r\n          };\r\n        }\r\n      })\r\n    };\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nconst Filter = ({\r\n  keys,\r\n  types,\r\n  initialFilters,\r\n  updateFilters,\r\n  options,\r\n  defaultCondition, \r\n  keysMeta,\r\n  closePopover,\r\n}) => {\r\n  const [rootGroup, setRootGroup] = useState(() => {\r\n    if (!initialFilters) return null;\r\n    return initialFilters.isGroup\r\n      ? initialFilters\r\n      : convertBackendToUIFilter(initialFilters);\r\n  });\r\n\r\n  const hasFilters = (rootGroup?.rules || []).length > 0;\r\n  const showFilterGroup = Boolean(rootGroup && hasFilters);\r\n\r\n  const handleApply = () => {\r\n    const backendFilter = cleanFilterForBackend(rootGroup);\r\n    updateFilters(backendFilter);\r\n    closePopover();\r\n  };\r\n\r\n  const addToRoot = (item) => {\r\n    if (!rootGroup) return;\r\n    const currentRules = rootGroup.rules || [];\r\n    setRootGroup({\r\n      ...rootGroup,\r\n      rules: [...currentRules, item],\r\n    });\r\n  };\r\n\r\n  const createRootWithCondition = () => {\r\n    setRootGroup(createGroup([createCondition({}, defaultCondition)]));\r\n  };\r\n\r\n  const createRootWithGroup = () => {\r\n    const emptyGroup = createGroup();\r\n    setRootGroup(createGroup([emptyGroup]));\r\n  };\r\n\r\n  const handleAddConditionToRoot = () =>\r\n    addToRoot(createCondition({}, defaultCondition));\r\n  const handleAddGroupToRoot = () => addToRoot(createGroup());\r\n\r\n  useEffect(() => {\r\n    if (initialFilters) {\r\n      const uiFormatted = initialFilters.isGroup\r\n        ? initialFilters\r\n        : convertBackendToUIFilter(initialFilters);\r\n      setRootGroup(uiFormatted);\r\n    }\r\n  }, [initialFilters]);\r\n\r\n  return (\r\n    <div className=\"text-slate-600 w-full\">\r\n      <div className=\"flex items-center gap-2 mb-4\">\r\n        <FAIcon icon=\"filter\" className=\"text-primary-700\" size=\"lg\" />\r\n        <h2 className=\"text-lg font-medium text-gray-800\">Filter</h2>\r\n      </div>\r\n\r\n      {!rootGroup ? (\r\n        <AddButtons\r\n          onAddCondition={createRootWithCondition}\r\n          onAddGroup={createRootWithGroup}\r\n        />\r\n      ) : (\r\n        <>\r\n          {showFilterGroup && (\r\n            <div className=\"flex gap-2 items-start mb-4\">\r\n              <div className=\"flex-1\">\r\n                <FilterGroup\r\n                  group={rootGroup}\r\n                  onChange={setRootGroup}\r\n                  onRemove={() => setRootGroup(null)}\r\n                  keys={keys}\r\n                  types={types}\r\n                  options={options}\r\n                  defaultCondition={defaultCondition} \r\n                  keysMeta={keysMeta}\r\n                  level={0}\r\n                  isRoot={true}\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"flex justify-between items-center gap-10\">\r\n            <AddButtons\r\n              onAddCondition={handleAddConditionToRoot}\r\n              onAddGroup={handleAddGroupToRoot}\r\n            />\r\n            <Button\r\n              className=\"rounded-sm shadow-sm text-xs transition-all hover:shadow-md\"\r\n              onClick={handleApply}\r\n            >\r\n              <FAIcon icon=\"filter\" className=\"mr-1\" size=\"sm\" />\r\n              <span>Apply</span>\r\n            </Button>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Filter;\r\n","import FiltersInner from \"./Filter\";\r\nimport { cn } from \"@ankamala/core\";\r\n\r\n\r\nexport default function Filters({ className, closePopover, options, filterData, defaultCondition, filters, updateFilters, keysMeta }) {\r\n\r\n  return (\r\n    <div className={cn(className)}>\r\n      <FiltersInner\r\n        keys={filterData?.fields || []}\r\n        types={filterData?.types || {}}\r\n        initialFilters={filters}\r\n        updateFilters={updateFilters}\r\n        options={options} \r\n        defaultCondition={defaultCondition}\r\n        keysMeta={keysMeta}\r\n        closePopover={closePopover}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import { useState } from \"react\";\r\nimport { Button, FAIcon, Popover, PopoverTrigger, PopoverContent, TooltipProvider } from \"@ankamala/core\";\r\nimport Filters from \"./Filters\";\r\nimport { countConditions } from \"../utils/filterUtils\";\r\n\r\n\r\nexport default function FilterPopover({ options, filterData, defaultCondition, filters, updateFilters, keysMeta }) {\r\n  const [isPopoverOpen, setPopoverOpen] = useState(false);\r\n\r\n  const filterCount = countConditions(filters);\r\n\r\n  const togglePopover = () => setPopoverOpen(!isPopoverOpen);\r\n  const closePopover = () => setPopoverOpen(false);\r\n\r\n  return (\r\n    <Popover\r\n      className=\"z-10\"\r\n      style={{ zIndex: 10 }}\r\n      open={isPopoverOpen}\r\n      onOpenChange={togglePopover}\r\n    >\r\n      <PopoverTrigger asChild>\r\n        <Button className=\"rounded-sm h-10 w-10 text-lg shadow-lg relative\">\r\n          <FAIcon icon=\"filter\" />\r\n          {filterCount > 0 && (\r\n            <span className=\"absolute top-0 right-0 text-xs bg-primary-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-center -mr-2 -mt-2\">\r\n              {filterCount}\r\n            </span>\r\n          )}\r\n        </Button>\r\n      </PopoverTrigger>\r\n\r\n      <PopoverContent className=\"max-w-[60vw] w-auto max-h-[70vh] overflow-y-auto rounded-none bg-gray-50 border-t-2 border-t-primary-700 p-6\">\r\n        <TooltipProvider>\r\n        <Filters \r\n          closePopover={closePopover}\r\n          options={options}\r\n          filterData={filterData}\r\n          defaultCondition={defaultCondition}\r\n          filters={filters}\r\n          updateFilters={updateFilters}\r\n          keysMeta={keysMeta}\r\n        />\r\n        </TooltipProvider>\r\n      </PopoverContent>\r\n    </Popover>\r\n  );\r\n}\r\n"],"names":["w","e","o","s","v","className","d","i","icon","k","a","selected","leftIcon","rightIcon","t","r","iconClassName","placeholder","maxWidth","l","c","m","n","ref","children","length","Array","isArray","label","displayName","adjustValueType","value","filterType","Number","dayjs","isValid","Date","Boolean","parseFloat","Fence","<","b",">",">=","<=","=","some","item","includes","!=","contains","toLowerCase","beginswith","startsWith","process","operator","this","evaluateFilter","schema","rules","every","sub","key","undefined","itemValue","error","console","warn","processDateFiltersInSchema","fieldMeta","map","and","or","_fieldMeta$all","all","_fieldMeta$all$map$ke","type","countConditions","node","reduce","sum","DatePicker","onChange","format","dateFormat","calendarClassName","formattedDate","_jsxs","Popover","_jsx","PopoverTrigger","asChild","Button","variant","cn","PopoverContent","align","Calendar","classNames","head_cell","cell","mode","onSelect","initialFocus","getOptionValue","option","path","SelectedOptionsDisplay","onRemove","onClearAll","sortedSelected","slice","sort","labelA","labelB","localeCompare","onClick","stopPropagation","FAIcon","Tooltip","tooltipText","RecursiveOptions","options","onOptionSelect","multiple","isSmall","optionTooltip","sortedOptions","_a$label","_b$label","index","isLoading","CommandItem","disabled","Spinner","isSelected","CommandGroup","heading","content","side","RichSelect","trigger","isSearchable","isShadow","showSelectedSummary","onSearchChange","searchPlaceholder","shouldFilter","searchFields","openMain","setOpenMain","useState","searchValue","setSearchValue","filteredOptions","filterOptions","opts","search","searchLower","flatMatches","flattened","traverse","items","forEach","push","flattenOptions","filter","opt","field","_opt$field","matchPaths","Set","filterRecursive","groupMatches","groupMatchesSearch","groupLabel","matchedGroup","filteredChildren","has","handleOptionSelect","newSelected","open","onOpenChange","sideOffset","TooltipProvider","CommandLibrary","CommandInput","onValueChange","CommandList","CommandEmpty","operatorMap","number","string","date","boolean","select","__all__","inputTypes","FilterItem","removeFilter","keys","types","handleFilterChange","keysMeta","_keysMeta$key","id","useMemo","operators","inputType","optionsArray","_options$key","dateValue","handleSelectChange","newProperties","Select","newValue","SelectTrigger","SelectValue","SelectContent","SelectItem","val","find","extracted","_optionsArray$find","R","renderSelectTrigger","Switch","onCheckedChange","checked","thumbStyle","Input","defaultValue","onBlur","_e$target","target","generateId","_crypto","crypto","randomUUID","createCondition","overrides","defaultCondition","isGroup","createGroup","AddButtons","onAddCondition","onAddGroup","canAddGroup","level","isMaxLevel","baseButtonClass","LogicSelector","toUpperCase","FilterGroup","group","isRoot","logic","updateChild","updated","updatedChildren","child","removeChild","addToGroup","updateLogic","newLogic","showGroupStyling","showGroupControls","isEmpty","props","handleAddCondition","handleAddGroup","cleanFilterForBackend","condition","convertBackendToUIFilter","backendGroup","rule","_crypto2","Filter","initialFilters","updateFilters","closePopover","rootGroup","setRootGroup","hasFilters","showFilterGroup","addToRoot","currentRules","useEffect","uiFormatted","size","_Fragment","handleAddConditionToRoot","handleAddGroupToRoot","handleApply","backendFilter","createRootWithCondition","createRootWithGroup","emptyGroup","Filters","filterData","filters","FiltersInner","fields","isPopoverOpen","setPopoverOpen","filterCount","style","zIndex","togglePopover","features","processedFilters"],"mappings":"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"}