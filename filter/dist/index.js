"use strict";var e=require("react"),t=require("@radix-ui/react-slot"),r=require("class-variance-authority"),a=require("clsx"),s=require("tailwind-merge"),o=require("@fortawesome/react-fontawesome"),l=require("react/jsx-runtime"),n=require("@radix-ui/react-popover"),i=require("@fortawesome/fontawesome-svg-core"),d=require("@fortawesome/free-solid-svg-icons"),c=require("@radix-ui/react-select"),u=require("@radix-ui/react-switch"),m=require("@radix-ui/react-tooltip"),p=require("cmdk"),f=require("react-day-picker"),x=require("dayjs/esm"),h=require("date-fns");function y(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if("default"!==r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,Object.freeze(t)}var g=y(e),b=y(n),v=y(c),w=y(u),j=y(m);function N(...e){return s.twMerge(a.clsx(e))}const C=({className:e})=>l.jsx(o.FontAwesomeIcon,{icon:"spinner",className:N("animate-spin text-primary-600",e)}),k=e.forwardRef(({selected:e,leftIcon:t,rightIcon:r,className:a,iconClassName:s,placeholder:n,maxWidth:i="max-w-20",...d},c)=>l.jsxs("button",{ref:c,className:N("flex items-center border-b pb-1 px-2 text-gray-500 text-sm font-light cursor-pointer min-w-0 overflow-hidden",a),...d,children:[l.jsxs("div",{className:"flex text-start items-center justify-center truncate min-w-0",children:[t&&l.jsx(o.FontAwesomeIcon,{icon:t,className:N("h-3 w-3 text-secondary-500 flex-shrink-0",s)}),l.jsx("span",{className:`truncate min-w-0 ${i} ${t?"pl-1":""}`,children:e&&e.length?Array.isArray(e)?`${e.length} selected`:e.label:n})]}),r&&l.jsx(o.FontAwesomeIcon,{icon:r,className:"h-3 w-3 pl-1 flex-shrink-0"})]}));k.displayName="SelectTrigger";const A=r.cva("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary-700 text-primary-50 shadow hover:bg-primary-800",danger:"bg-red-700 text-red-50 shadow-sm hover:bg-red-800",outline:"border border-input shadow-sm hover:bg-gray-100",secondary:"bg-secondary-700 text-secondary-50 shadow-sm hover:bg-secondary-800",ghost:"hover:bg-primary-50",link:"text-primary-800 underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),F=e.forwardRef(({className:e,variant:r,size:a,asChild:s=!1,loading:o=!1,children:n,...i},d)=>{const c=s?t.Slot:"button",u=s?l.jsxs("span",{className:"inline-flex items-center",children:[o&&l.jsx(C,{className:"mr-2 h-4 w-4 animate-spin text-current"}),n]}):l.jsxs(l.Fragment,{children:[o&&l.jsx(C,{className:"mr-2 h-4 w-4 animate-spin text-current"}),n]});return l.jsx(c,{className:N(A({variant:r,size:a,className:e})),title:i.title,ref:d,disabled:i.disabled||o,...i,children:u})});F.displayName="Button";const S=g.forwardRef(({className:e,type:t,...r},a)=>l.jsx("input",{type:t,className:N("flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...r}));S.displayName="Input";const I=b.Root,M=b.Trigger,R=g.forwardRef(({className:e,align:t="center",sideOffset:r=4,...a},s)=>l.jsx(b.Portal,{children:l.jsx(b.Content,{ref:s,align:t,sideOffset:r,className:N("bg-popover text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));R.displayName=b.Content.displayName,i.config.autoAddCss=!1,i.library.add(d.faCheck,d.faXmark,d.faFilter);const _=v.Root,D=v.Value,L=g.forwardRef(({iconClassName:e,className:t,isIconShow:r=!0,children:a,...s},n)=>l.jsxs(v.Trigger,{ref:n,className:N("flex h-9 w-full items-center whitespace-nowrap rounded-sm border bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...s,children:[l.jsx(v.Icon,{asChild:!0,children:r&&l.jsx(o.FontAwesomeIcon,{icon:"sort",className:N("mr-2 w-4 h-4",e)})}),a]}));L.displayName=v.Trigger.displayName;const G=g.forwardRef(({className:e,...t},r)=>l.jsx(v.ScrollUpButton,{ref:r,className:N("flex justify-center items-center py-1 cursor-default",e),...t,children:l.jsx(o.FontAwesomeIcon,{icon:"chevron-up"})}));G.displayName=v.ScrollUpButton.displayName;const T=g.forwardRef(({className:e,...t},r)=>l.jsx(v.ScrollDownButton,{ref:r,className:N("flex justify-center items-center py-1 cursor-default",e),...t,children:l.jsx(o.FontAwesomeIcon,{icon:"chevron-down"})}));T.displayName=v.ScrollDownButton.displayName;const q=g.forwardRef(({className:e,children:t,position:r="popper",...a},s)=>l.jsx(v.Portal,{children:l.jsxs(v.Content,{ref:s,className:N("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-sm border bg-white text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...a,children:[l.jsx(G,{}),l.jsx(v.Viewport,{className:N("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),l.jsx(T,{})]})}));q.displayName=v.Content.displayName;const O=g.forwardRef(({className:e,...t},r)=>l.jsx(v.Label,{ref:r,className:N("px-2 py-1.5 text-sm font-semibold opacity-70",e),...t}));O.displayName=v.Label.displayName;const z=g.forwardRef(({className:e,children:t,...r},a)=>l.jsxs(v.Item,{ref:a,className:N("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-slate-100 focus:text-primary-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[l.jsx("span",{className:"flex absolute right-2 justify-center items-center w-3.5 h-3.5",children:l.jsx(v.ItemIndicator,{children:l.jsx(o.FontAwesomeIcon,{icon:"check",className:"w-4 h-4"})})}),l.jsx(v.ItemText,{children:t})]}));z.displayName=v.Item.displayName;const P=g.forwardRef(({className:e,...t},r)=>l.jsx(v.Separator,{ref:r,className:N("-mx-1 my-1 h-px bg-muted",e),...t}));P.displayName=v.Separator.displayName;const B=g.forwardRef(({className:e,thumbStyle:t,...r},a)=>l.jsx(w.Root,{className:N("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary-600 data-[state=unchecked]:bg-gray-400",e),...r,ref:a,children:l.jsx(w.Thumb,{className:N("pointer-events-none block h-5 w-5 rounded-full bg-primary-300 shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0",t)})}));B.displayName=w.Root.displayName;const V=({icon:e,children:t,tooltipText:r,side:a="top",className:s})=>l.jsxs(j.Root,{delayDuration:0,children:[l.jsx(j.Trigger,{asChild:!0,children:l.jsxs("span",{children:[e&&l.jsx(o.FontAwesomeIcon,{icon:e,className:s}),t]})}),l.jsxs(j.Content,{side:a,className:"bg-black text-white text-xs rounded px-2 py-1 shadow-md",children:[r,l.jsx(j.Arrow,{className:"fill-black"})]})]}),U=j.Provider,E=p.Command,W=g.forwardRef((e,t)=>{const{className:r,...a}=e;return l.jsx(p.Command.List,{ref:t,className:N("max-h-[340px] overflow-y-auto overflow-x-hidden scroll-smooth scroll-padding",r),...a})});W.displayName=p.Command.List.displayName;const $=g.forwardRef((e,t)=>{const{className:r,...a}=e;return l.jsx(p.Command.Input,{ref:t,className:N("flex h-10 w-full border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50",r),...a})});$.displayName=p.Command.Input.displayName;const X=g.forwardRef((e,t)=>{const{className:r,...a}=e;return l.jsx(p.Command.Item,{ref:t,className:N("relative flex cursor-default select-none items-center px-2 py-1.5 text-sm outline-none transition-colors duration-200 ",r),...a})});X.displayName=p.Command.Item.displayName;const H=g.forwardRef((e,t)=>{const{className:r,...a}=e;return l.jsx(p.Command.Group,{ref:t,className:N("overflow-hidden text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-0 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",r),...a})});H.displayName=p.Command.Group.displayName;const J=g.forwardRef((e,t)=>{const{className:r,...a}=e;return l.jsx(p.Command.Separator,{ref:t,className:N("-mx-1 h-px bg-border",r),...a})});J.displayName=p.Command.Separator.displayName;const K=g.forwardRef(({className:e,...t},r)=>l.jsx(p.Command.Dialog,{ref:r,className:N("fixed inset-0 z-50 flex items-start justify-center p-4 pt-[25vh] backdrop-blur-md",e),...t,children:l.jsx("div",{className:"w-full max-w-md rounded-md bg-background shadow-lg",children:t.children})}));K.displayName=p.Command.Dialog.displayName;const Q=g.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:N("flex items-center justify-center p-4 text-sm text-muted-foreground",e),...t,children:"No results found."}));function Y({className:e,classNames:t,showOutsideDays:r=!0,...a}){return l.jsx(f.DayPicker,{showOutsideDays:r,className:N("p-3",e),classNames:{months:"flex flex-col lg:flex-row space-y-16 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-xs font-medium",nav:"space-x-1 flex items-center",nav_button:N(A({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-200"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-0",cell:"h-8 w-8 text-center text-sm p-2 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:N(A({variant:"ghost"}),"h-8 w-8 hover:bg-primary-100 p-1 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary-600 text-white hover:bg-primary-600 hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...e})=>l.jsx(o.FontAwesomeIcon,{icon:"chevron-left",className:"w-4 h-4"}),IconRight:({...e})=>l.jsx(o.FontAwesomeIcon,{icon:"chevron-right",className:"w-4 h-4"})},...a})}Q.displayName="CommandEmpty",Y.displayName="Calendar";const Z=(e,t)=>{switch(t){case"number":return Number(e);case"date":return x(e).isValid()?new Date(e):new Date;case"boolean":return Boolean(e);case"float":return parseFloat(e);default:return e}},ee={"<":(e,t)=>e<t,">":(e,t)=>e>t,">=":(e,t)=>e>=t,"<=":(e,t)=>e<=t,"=":(e,t)=>Array.isArray(e)&&Array.isArray(t)?t.some(t=>e.includes(t)):Array.isArray(e)?e.includes(t):Array.isArray(t)?t.includes(e):e===t,"!=":(e,t)=>Array.isArray(e)&&Array.isArray(t)?!t.some(t=>e.includes(t)):Array.isArray(e)?!e.includes(t):Array.isArray(t)?!t.includes(e):e!==t,contains:(e,t)=>"string"==typeof e&&"string"==typeof t&&e.toLowerCase().includes(t.toLowerCase()),beginswith:(e,t)=>"string"==typeof e&&"string"==typeof t&&e.toLowerCase().startsWith(t.toLowerCase()),process(e,t,r){return this[r](e,t)}};function te(e,t){if(!t)return!0;if(t.operator&&Array.isArray(t.rules)&&1===t.rules.length)return te(e,t.rules[0]);if(Array.isArray(t))return t.every(t=>te(e,t));if(t.operator&&Array.isArray(t.rules)){const r=t.operator.toLowerCase();if("and"===r)return t.rules.every(t=>te(e,t));if("or"===r)return t.rules.some(t=>te(e,t))}if(t.key&&t.operator&&void 0!==t.value){const{key:r,value:a,operator:s}=t;let o=e[r];if(null==o)return("!="===s||"not_equals"===s)&&(null!=a&&""!==a);try{return ee.process(o,a,s)}catch(e){return console.warn("Filter evaluation error:",e,{key:r,value:a,operator:s,itemValue:o}),!1}}return!0}function re(e,t){if(!e)return e;return Array.isArray(e)?e.map(e=>re(e,t)):e.operator&&Array.isArray(e.rules)?{...e,rules:e.rules.map(e=>re(e,t))}:e.and?{...e,and:e.and.map(e=>re(e,t))}:e.or?{...e,or:e.or.map(e=>re(e,t))}:e.key&&((r=e.key)&&null!=t&&null!==(a=t.all)&&void 0!==a&&a.map&&"date"===(null===(s=t.all.map[r])||void 0===s?void 0:s.type))&&"string"==typeof e.value?{...e,value:new Date(e.value)}:e;var r,a,s}const ae=(e,t,r,a)=>{if(!t)return Array.isArray(e)?[...e]:[];const s=re(t,a);return e.filter(e=>te(r&&r[e.id]?r[e.id]:e,s))};function se(e){return e?Array.isArray(e)?e.reduce((e,t)=>e+se(t),0):e.rules&&Array.isArray(e.rules)?se(e.rules):e.key?1:0:0}function oe({placeholder:e="Enter a date",value:t,onChange:r,format:a="yyyy MMM dd",calendarClassName:s,className:o}){const n=t?h.format(t,a):"";return l.jsxs(I,{children:[l.jsx(M,{asChild:!0,children:l.jsx(F,{variant:"outline",className:N("text-xs border-0 border-b-[1px] shadow-none p-1 justify-start text-left font-normal",!t&&"text-slate-500",o),children:t?n:l.jsx("span",{children:e})})}),l.jsx(R,{className:"p-0 w-auto",align:"start",children:l.jsx(Y,{className:N("bg-gray-100",s),classNames:{head_cell:"h-8 w-8 text-sm font-medium",cell:"h-8 w-8 text-slate-600"},mode:"single",selected:t,onSelect:e=>{r(e)},initialFocus:!0})})]})}const le=e=>"object"==typeof e?e.path:e,ne=({selected:e,onRemove:t,onClearAll:r})=>{const a=e.slice().sort((e,t)=>{const r="object"==typeof e?e.label:e,a="object"==typeof t?t.label:t;return r.localeCompare(a)});return l.jsxs("div",{className:"relative flex items-center justify-between px-4 pt-2 pb-4 gap-2 border-b pr-8",children:[l.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(e=>l.jsxs("span",{onClick:r=>{r.stopPropagation(),t(e)},className:"flex items-center bg-primary-400/10 text-[10px] px-1 py-0.5 rounded-sm cursor-pointer hover:bg-gray-200 transition",children:["object"==typeof e?e.label:e,l.jsx(o.FontAwesomeIcon,{icon:"close",className:"h-2 w-2 ml-1 text-primary-600"})]},le(e)))}),l.jsx("div",{onClick:e=>{e.stopPropagation(),r()},className:"absolute top-1 right-2 cursor-pointer",children:l.jsx(V,{tooltipText:"Clear all",icon:"close",className:"h-4 w-4 mr-1 text-gray-500 hover:text-gray-800 transition"})})]})},ie=({options:e,selected:t,onOptionSelect:r,className:a,multiple:s,isSmall:n,optionTooltip:i})=>{const d=e.slice().sort((e,t)=>{var r,a;const s=(null===(r=e.label)||void 0===r?void 0:r.toLowerCase())??"",o=(null===(a=t.label)||void 0===a?void 0:a.toLowerCase())??"";return s.localeCompare(o)});return l.jsx("div",{className:N(a),children:d.map((e,a)=>{if(e.isLoading)return l.jsx(X,{value:e.label,className:"px-4 py-2 text-sm text-gray-500 cursor-default",disabled:!0,children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(C,{className:"w-4 h-4"}),l.jsx("span",{children:e.label})]})},"loading-state");const d=s||n?t.some(t=>le(t)===le(e)):t&&le(t)===le(e);if(e.options)return l.jsx(H,{className:"px-2 mt-2 overflow-visible",heading:l.jsx("span",{className:"cursor-default font-bold text-sm text-gray-800 whitespace-nowrap",children:e.label}),children:l.jsx(ie,{options:e.options,selected:t,onOptionSelect:r,multiple:s,isSmall:n,optionTooltip:i})},a);{const t=l.jsx(X,{value:e.label,className:N("px-4 cursor-pointer hover:bg-gray-100 font-light border-b border-gray-100 whitespace-nowrap",d&&"bg-primary-400/10"),onSelect:()=>r(e),children:l.jsxs("div",{className:"flex justify-between items-center w-full gap-2",children:[l.jsx("span",{className:"whitespace-nowrap",children:e.label}),d&&l.jsx(o.FontAwesomeIcon,{icon:"check",className:"text-primary-600 h-3 w-3 ml-2 flex-shrink-0"})]})},a);if(i){const r="function"==typeof i?i(e):null==i?void 0:i[e.path];return r?l.jsx(V,{tooltipText:r,side:"right",children:t},a):t}return t}})})},de=({options:t,selected:r=[],onSelect:a,trigger:s,children:o,className:n,multiple:i=!1,isSearchable:d=!0,isSmall:c=!1,isShadow:u=!0,showSelectedSummary:m=!0,onSearchChange:p,searchPlaceholder:f="Search...",shouldFilter:x=!0,optionTooltip:h,searchFields:y=["label"]})=>{const[g,b]=e.useState(!1),[v,w]=e.useState(""),j=x?((e,t)=>{if(!t)return e;const r=t.toLowerCase(),a=(e=>{const t=[],r=e=>{e.forEach(e=>{e.options?r(e.options):e.isLoading||t.push(e)})};return r(e),t})(e).filter(e=>y.some(t=>{var a;return null===(a=e[t])||void 0===a?void 0:a.toLowerCase().includes(r)})),s=new Set(a.map(e=>e.path)),o=e=>e.map(e=>{if(e.options){const r=((e,t)=>e.toLowerCase().includes(t.toLowerCase()))(e.label,t);if(r)return{...e,matchedGroup:!0};const a=o(e.options);return a.length>0?{...e,options:a,matchedGroup:!1}:null}return e.isLoading||s.has(e.path)?e:null}).filter(Boolean);return o(e)})(t,v):t,C=e=>{if(i){const t=r.some(t=>le(t)===le(e))?r.filter(t=>le(t)!==le(e)):[...r,e];a(t)}else a(e),b(!1)};return l.jsx("div",{className:N("relative flex",n),children:l.jsxs(I,{open:g,onOpenChange:b,children:[l.jsx(M,{asChild:!0,className:"flex items-center gap-1 text-gray-500 text-sm "+(c?"border-none px-1 text-xs py-0":"border-b px-2 py-1"),children:o||s(r)}),l.jsx(R,{align:"start",sideOffset:4,className:N("bg-white border w-auto",!u&&"shadow-none"),children:l.jsx(U,{children:l.jsxs(E,{shouldFilter:!1,children:[d&&l.jsx($,{placeholder:f,className:"px-4 py-2 mb-2 border-b border-gray-300",onValueChange:e=>{w(e),p&&p(e)}}),l.jsxs(W,{children:[i&&r.length>0&&("always"===m||!1!==m&&t.length>6)&&l.jsx(ne,{selected:r,onRemove:C,onClearAll:()=>a([])}),l.jsx(ie,{options:j,selected:r,onOptionSelect:C,multiple:i,isSmall:c,optionTooltip:h}),0===j.length&&l.jsx(Q,{})]})]})})})]})})},ce={number:["<",">","<=",">="],string:["contains","beginswith"],date:["<",">","<=",">="],boolean:[],select:[],__all__:["=","!="]},ue={number:"number",string:"text",date:"date"},me=({removeFilter:t,filter:r,keys:a,types:s,handleFilterChange:n,options:i,keysMeta:d})=>{var c;const{key:u,id:m,operator:p,value:f}=r,x=e.useMemo(()=>u&&s[u],[u,s]),h=e.useMemo(()=>x?[...ce.__all__,...ce[x]]:ce.__all__,[x]),y=e.useMemo(()=>ue[x]||"text",[x]),g=e.useMemo(()=>{var e;return"select"===x&&null!=i&&null!==(e=i[u])&&void 0!==e&&e.length?i[u]:[]},[x,i,u]),b=e.useMemo(()=>"date"===x&&f?Z(f,"date"):null,[x,f]),v=(e,t)=>{let r;r="key"===e?{[e]:t,operator:"=",value:Z("",s[t])}:{[e]:t},n(m,r)};return l.jsxs("div",{className:"flex gap-2 items-center w-full",children:[l.jsxs("div",{className:"flex gap-4 items-center w-full",children:[l.jsx("div",{className:"flex-shrink-0 w-[200px]",children:l.jsx(de,{selected:u,onSelect:e=>v("key",e.path),options:a,children:l.jsxs("button",{className:"border-b-[1px] pl-2 text-sm focus:ring-0 flex items-center w-full h-9",children:[l.jsx(o.FontAwesomeIcon,{icon:"sort",className:"h-3 w-3"}),l.jsx("span",{className:"truncate",children:null===(c=d[u])||void 0===c?void 0:c.label})]})})}),l.jsx("div",{className:"flex-shrink-0 w-[75px]",children:l.jsxs(_,{onValueChange:e=>v("operator",e),value:p,children:[l.jsx(L,{iconClassName:"h-3 w-3 text-gray-500",className:"border-0 border-b-[1px] shadow-none focus:ring-0 text-sm pl-0 text-gray-600 w-full",children:l.jsx(D,{className:"text-slate-700 truncate",placeholder:"Select"})}),l.jsx(q,{className:"text-slate-700",children:h.map(e=>l.jsx(z,{value:e,children:e},e))})]})}),l.jsxs("div",{className:"flex-1",children:["select"===x&&l.jsx(de,{options:g,selected:d[u].multiple?Array.isArray(f)?f.map(e=>g.find(t=>t.path===e)||e):[]:g.find(e=>e.path===f)||f,onSelect:e=>{const t=Array.isArray(e)?e.map(e=>e.path??e):e.path??e;v("value",t)},multiple:d[u].multiple??!1,isSearchable:!0,isSmall:!1,showSelectedSummary:!1,trigger:e=>{var t;return((e,t,r,a,s,o)=>l.jsx(k,{selected:e,leftIcon:t,rightIcon:r,className:a,iconClassName:s,placeholder:o,maxWidth:"flex-1"}))(e,"sort",null,"border-b-[1px] pl-2 text-sm focus:ring-0 flex items-center w-full h-9","mr-2",d[u].multiple?"Select":(null===(t=g.find(e=>e.path===f))||void 0===t?void 0:t.label)||"Select")}}),"date"===x&&l.jsx(oe,{placeholder:"Enter a date",value:b,format:"yyyy MMM dd",onChange:e=>v("value",e),className:"w-full text-sm",calendarClassName:"border-t-2 border-primary-600"},"date"),"boolean"===x&&l.jsx("div",{className:"flex justify-center items-center h-full text-center",children:l.jsx(V,{tooltipText:"Toggle to enable or disable",className:"mr-2 text-gray-500",children:l.jsx(B,{onCheckedChange:e=>v("value",!!e),checked:!!f,className:"w-10 h-4.5 rounded-full border-transparent transition-colors data-[state=checked]:bg-primary-700 data-[state=unchecked]:bg-gray-500",thumbStyle:"w-4 h-4 bg-white rounded-full shadow-md transform transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0"})})}),("string"===x||"number"===x)&&l.jsx(S,{defaultValue:f,placeholder:"Enter a value",onBlur:e=>{var t;return v("value",Z(null==e||null===(t=e.target)||void 0===t?void 0:t.value,x))},type:y,className:"pl-2 bg-transparent text-sm rounded-none border-t-0 border-r-0 border-b-[1px] border-l-0 focus:ring-2 focus:ring-primary-500 focus:border-transparent h-9 w-full"})]})]}),l.jsx(V,{tooltipText:"Remove item",children:l.jsx("div",{onClick:()=>t(m),className:"cursor-pointer",children:l.jsx(o.FontAwesomeIcon,{icon:"multiply"})})})]})},pe=()=>{var e;return null===(e=crypto)||void 0===e?void 0:e.randomUUID()},fe=(e={},t)=>({id:pe(),...t,...e,isGroup:!1}),xe=(e=[],t="and")=>({id:pe(),isGroup:!0,operator:t.toLowerCase(),rules:e}),he=({onAddCondition:e,onAddGroup:t,canAddGroup:r=!0,level:a=0})=>{const s=a>=2,o="text-gray-600 font-medium cursor-pointer hover:text-primary-600 text-sm";return l.jsxs("div",{className:"flex gap-4",children:[l.jsx("span",{className:o,onClick:e,children:"+ Add condition"}),r&&(s?l.jsx(V,{tooltipText:"Filter condition can only be nested three level deep",children:l.jsx("span",{className:"text-gray-400 text-sm cursor-not-allowed",children:"+ Add condition group"})}):l.jsx("span",{className:o,onClick:t,children:"+ Add condition group"}))]})},ye=({value:e,onChange:t})=>l.jsxs(_,{defaultValue:e.toUpperCase(),onValueChange:e=>t(e.toLowerCase()),children:[l.jsx(L,{iconClassName:"h-3 w-3 text-gray-500",className:"border-0 border-b-[1px] shadow-none focus:ring-0 text-sm pl-0 text-gray-600 w-[55px]",children:l.jsx(D,{})}),l.jsxs(q,{children:[l.jsx(z,{value:"AND",children:"and"}),l.jsx(z,{value:"OR",children:"or"})]})]}),ge=({group:e,onChange:t,onRemove:r,keys:a,types:s,options:n,defaultCondition:i,keysMeta:d,level:c=0,isRoot:u=!1})=>{const m=e.rules||[],p=e.operator||e.logic||"and",f=(r,a)=>{const s=m.map(e=>e.id===r?a:e);t({...e,rules:s})},x=r=>{const a=m.filter(e=>e.id!==r);t({...e,rules:a})},h=r=>{t({...e,rules:[...m,r]})},y=r=>{t({...e,operator:r.toLowerCase()})},g=!u,b=!u,v=0===m.length;return l.jsxs("div",{className:N("flex flex-col gap-4",g&&"rounded-sm py-2 px-4 border bg-gray-100"),children:[v&&b&&l.jsx("div",{className:"text-sm font-light",children:"Add conditions or sub-groups."}),m.map((e,t)=>l.jsxs("div",{className:"flex gap-2 items-start",children:[0===t?l.jsx("span",{className:"w-[55px] pt-2 text-sm font-medium text-gray-700",children:"Where"}):1===t?l.jsx(ye,{value:p,onChange:y}):l.jsx("span",{className:"w-[55px] pt-2 text-sm text-gray-700",children:p}),l.jsx("div",{className:"flex-1",children:e.isGroup?l.jsx(ge,{group:e,onChange:t=>f(e.id,t),onRemove:()=>x(e.id),keys:a,types:s,options:n,defaultCondition:i,keysMeta:d,level:c+1,isRoot:!1}):l.jsx(me,{filter:e,handleFilterChange:(t,r)=>f(e.id,{...e,...r}),removeFilter:()=>x(e.id),types:s,keys:a,options:n,keysMeta:d})})]},e.id)),b&&l.jsxs("div",{className:"flex justify-between gap-10 items-center pt-2 border-t border-gray-200",children:[l.jsx(he,{onAddCondition:()=>h(fe({},i)),onAddGroup:()=>h(xe()),level:c}),l.jsx(V,{tooltipText:"Remove group",children:l.jsx("button",{onClick:r,className:"text-gray-600 hover:text-gray-900 transition-colors",children:l.jsx(o.FontAwesomeIcon,{icon:"multiply"})})})]})]})},be=({onAddCondition:e,onAddGroup:t})=>l.jsxs("div",{className:"flex gap-6",children:[l.jsx("span",{className:"text-gray-600 font-medium cursor-pointer hover:text-primary-600 text-sm",onClick:e,children:"+ Add condition"}),l.jsx("span",{className:"text-gray-600 font-medium cursor-pointer hover:text-primary-600 text-sm",onClick:t,children:"+ Add condition group"})]}),ve=e=>{if(!e)return null;if(!e.isGroup){const{id:t,isGroup:r,...a}=e;return a.key&&a.operator?a:null}const t=(e.rules||[]).map(e=>ve(e)).filter(Boolean);return 0===t.length?null:{operator:e.operator||"and",rules:t}},we=e=>{return e&&e.operator&&Array.isArray(e.rules)?{id:null===(t=crypto)||void 0===t?void 0:t.randomUUID(),isGroup:!0,operator:e.operator,rules:e.rules.map(e=>{return e.operator&&e.rules?we(e):{id:null===(t=crypto)||void 0===t?void 0:t.randomUUID(),isGroup:!1,...e};var t})}:null;var t},je=({keys:t,types:r,initialFilters:a,updateFilters:s,options:n,defaultCondition:i,keysMeta:d,closePopover:c})=>{const[u,m]=e.useState(()=>a?a.isGroup?a:we(a):null),p=((null==u?void 0:u.rules)||[]).length>0,f=Boolean(u&&p),x=e=>{if(!u)return;const t=u.rules||[];m({...u,rules:[...t,e]})};return e.useEffect(()=>{if(a){const e=a.isGroup?a:we(a);m(e)}},[a]),l.jsxs("div",{className:"text-slate-600 w-full",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(o.FontAwesomeIcon,{icon:"filter",className:"text-primary-700",size:"lg"}),l.jsx("h2",{className:"text-lg font-medium text-gray-800",children:"Filter"})]}),u?l.jsxs(l.Fragment,{children:[f&&l.jsx("div",{className:"flex gap-2 items-start mb-4",children:l.jsx("div",{className:"flex-1",children:l.jsx(ge,{group:u,onChange:m,onRemove:()=>m(null),keys:t,types:r,options:n,defaultCondition:i,keysMeta:d,level:0,isRoot:!0})})}),l.jsxs("div",{className:"flex justify-between items-center gap-10",children:[l.jsx(be,{onAddCondition:()=>x(fe({},i)),onAddGroup:()=>x(xe())}),l.jsxs(F,{className:"rounded-sm shadow-sm text-xs transition-all hover:shadow-md",onClick:()=>{const e=ve(u);s(e),c()},children:[l.jsx(o.FontAwesomeIcon,{icon:"filter",className:"mr-1",size:"sm"}),l.jsx("span",{children:"Apply"})]})]})]}):l.jsx(be,{onAddCondition:()=>{m(xe([fe({},i)]))},onAddGroup:()=>{const e=xe();m(xe([e]))}})]})};function Ne({className:e,closePopover:t,options:r,filterData:a,defaultCondition:s,filters:o,updateFilters:n,keysMeta:i}){return l.jsx("div",{className:N(e),children:l.jsx(je,{keys:(null==a?void 0:a.fields)||[],types:(null==a?void 0:a.types)||{},initialFilters:o,updateFilters:n,options:r,defaultCondition:s,keysMeta:i,closePopover:t})})}exports.FilterPopover=function({options:t,filterData:r,defaultCondition:a,filters:s,updateFilters:n,keysMeta:i,filterProps:d}){const[c,u]=e.useState(!1),m=d||{options:t,filterData:r,defaultCondition:a,filters:s,updateFilters:n,keysMeta:i},p=se(m.filters);return m.filterData?l.jsxs(I,{className:"z-10",style:{zIndex:10},open:c,onOpenChange:()=>u(!c),children:[l.jsx(M,{asChild:!0,children:l.jsxs(F,{className:"rounded-sm h-10 w-10 text-lg shadow-lg relative",children:[l.jsx(o.FontAwesomeIcon,{icon:"filter"}),p>0&&l.jsx("span",{className:"absolute top-0 right-0 text-xs bg-primary-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-center -mr-2 -mt-2",children:p})]})}),l.jsx(R,{className:"max-w-[60vw] w-auto max-h-[70vh] overflow-y-auto rounded-none bg-gray-50 border-t-2 border-t-primary-700 p-6",children:l.jsx(U,{children:l.jsx(Ne,{closePopover:()=>u(!1),options:m.options,filterData:m.filterData,defaultCondition:m.defaultCondition,filters:m.filters,updateFilters:m.updateFilters,keysMeta:m.keysMeta})})})]}):null},exports.applyFilterFn=ae,exports.useFilter=function(t=[],r=null){var a;const[s,o]=e.useState(null),l=e.useMemo(()=>{var e,t;if(null==r||!r.fields)return{fieldMeta:null,keysMeta:{},filterData:null,defaultCondition:null};const{fields:a}=r,s={all:{map:a.reduce((e,t)=>(e[t.path]={label:t.label,type:t.type||"string"},e),{})}},o=a.reduce((e,t)=>(e[t.path]={label:t.label,type:t.type||"string",multiple:!1},e),{});return{fieldMeta:s,keysMeta:o,filterData:{types:a.reduce((e,t)=>(e[t.path]=t.type||"string",e),{}),fields:a},defaultCondition:r.defaultCondition?{id:r.defaultCondition.key,key:r.defaultCondition.key,label:(null===(e=o[r.defaultCondition.key])||void 0===e?void 0:e.label)||r.defaultCondition.key,operator:r.defaultCondition.operator,value:r.defaultCondition.value,type:(null===(t=o[r.defaultCondition.key])||void 0===t?void 0:t.type)||"string",isGroup:!1}:null}},[r]),n=e.useMemo(()=>s&&l.fieldMeta?ae(t,s,null,l.fieldMeta):t,[t,s,l.fieldMeta]),i=e.useMemo(()=>!!s&&(Array.isArray(s)?s.length>0:!!s.rules&&s.rules.length>0),[s]),d=l.filterData?{filterData:l.filterData,defaultCondition:l.defaultCondition,filters:s,updateFilters:o,keysMeta:l.keysMeta}:null;return{filteredData:n,filters:s,setFilters:o,filterProps:d,clearFilters:()=>o(null),hasActiveFilters:i,filterCount:i?Array.isArray(s)?s.length:(null===(a=s.rules)||void 0===a?void 0:a.length)||0:0}};
//# sourceMappingURL=index.js.map
