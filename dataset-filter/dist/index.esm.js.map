{"version":3,"file":"index.esm.js","sources":["../src/FilterSection.js","../src/FilterItem.js","../src/FilterPanel.js","../src/FilterUtils.js","../src/DatasetFilter.js","../src/index.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport { ChevronDown } from \"lucide-react\";\r\n\r\nexport const FilterSection = ({ label, isNested = false, children, defaultExpanded = true }) => {\r\n  const [isExpanded, setIsExpanded] = useState(defaultExpanded);\r\n\r\n  const HeadingTag = isNested ? 'h4' : 'h3';\r\n  const headingClass = isNested\r\n    ? \"text-xs font-medium text-gray-700 pb-2\"\r\n    : \"text-[13px] font-semibold text-gray-800 tracking-wide uppercase pb-2\";\r\n\r\n  const containerClass = isNested ? \"\" : \" mb-3 border-b border-gray-200\";\r\n\r\n  return (\r\n    <div className={containerClass}>\r\n      <button\r\n        onClick={() => setIsExpanded(!isExpanded)}\r\n        className=\"w-full flex justify-between group\"\r\n      >\r\n        <HeadingTag className={headingClass}>{label}</HeadingTag>\r\n        <ChevronDown className={`w-5 h-5 text-gray-600 hover:text-primary-600 transition-transform ${isExpanded ? 'rotate-180' : ''}`} />\r\n      </button>\r\n\r\n      {isExpanded && <div className=\"mb-3 space-y-0.5\">{children}</div>}\r\n    </div>\r\n  );\r\n};\r\n","import { useCallback, useMemo, useState } from 'react';\r\nimport { Search, X } from 'lucide-react';\r\nimport { FilterSection } from './FilterSection';\r\n\r\nexport const CheckboxItem = ({ checked, onChange, label }) => {\r\n  return (\r\n    <label className=\"flex items-start gap-3 cursor-pointer group w-fit\">\r\n      <input\r\n        type=\"checkbox\"\r\n        checked={checked}\r\n        onChange={onChange}\r\n        className=\"mt-0.5 w-4 h-4 rounded-sm border-gray-300 accent-primary-600 focus:ring-primary-500 cursor-pointer transition-colors group-hover:border-primary-600\"\r\n      />\r\n      <span className=\"text-sm text-gray-900 font-light group-hover:text-primary-600 transition-colors\">\r\n        {label}\r\n      </span>\r\n    </label>\r\n  );\r\n};\r\n\r\nexport const CheckboxGroupFilter = ({ config = {}, value = [], onChange, isNested = false }) => {\r\n  const [showAll, setShowAll] = useState(false);\r\n  \r\n  const toggleOption = useCallback((option) => {\r\n    const newValue = value.includes(option) ? value.filter(v => v !== option) : [...value, option];\r\n    onChange(newValue.length ? newValue : undefined);\r\n  }, [value, onChange]);\r\n\r\n  if (!config.options || config.options.length === 0) return null;\r\n\r\n  const MAX_VISIBLE = 5;\r\n  const visibleOptions = showAll ? config.options : config.options.slice(0, MAX_VISIBLE);\r\n\r\n  return (\r\n    <FilterSection label={config.label} isNested={isNested}>\r\n      {visibleOptions.map(option => (\r\n        <CheckboxItem\r\n          key={option}\r\n          label={option}\r\n          checked={value?.includes(option) || false}\r\n          onChange={() => toggleOption(option)}\r\n        />\r\n      ))}\r\n\r\n      {config.options.length > MAX_VISIBLE && (\r\n        <button\r\n          onClick={() => setShowAll(!showAll)}\r\n          className=\"mt-2 text-primary-600 hover:text-primary-500 text-xs inline-flex items-center gap-1 underline\"\r\n        >\r\n          {showAll ? 'See less' : 'See all'}\r\n        </button>\r\n      )}\r\n    </FilterSection>\r\n  );\r\n};\r\n\r\n\r\nexport const RangeFilter = ({ config, value = [], onChange, isNested = false }) => {\r\n  const toggleRange = useCallback((label) => {\r\n    const newValue = value.includes(label) ? value.filter(v => v !== label) : [...value, label];\r\n    onChange(newValue.length ? newValue : undefined);\r\n  }, [value, onChange]);\r\n\r\n  if (!config.ranges?.length) return null;\r\n\r\n  return (\r\n    <FilterSection label={config.label} isNested={isNested}>\r\n      {config.ranges.map(range => (\r\n        <CheckboxItem\r\n          key={range.label}\r\n          label={range.label}\r\n          checked={value?.includes(range.label) || false}\r\n          onChange={() => toggleRange(range.label)}\r\n        />\r\n      ))}\r\n    </FilterSection>\r\n  );\r\n};\r\n\r\nexport const CheckboxFilter = ({ config, value = false, onChange }) => {\r\n  return (\r\n    <div>\r\n      <CheckboxItem\r\n        checked={!!value}\r\n        onChange={(e) => onChange(e.target.checked ? true : undefined)}\r\n        label={config.label}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const NestedGroupFilter = ({ config, filters, onFilterChange, defaultExpanded = true }) => {\r\n  if (!config.children || config.children.length === 0) return null;\r\n\r\n  return (\r\n    <FilterSection label={config.label} defaultExpanded={defaultExpanded}>\r\n      {config.children.map(childKey => {\r\n        const childConfig = config.childrenSchema[childKey];\r\n        if (!childConfig) return null;\r\n\r\n        if (childConfig.type === \"checkbox-group\") {\r\n          return (\r\n            <CheckboxGroupFilter\r\n              key={childKey}\r\n              config={childConfig}\r\n              value={filters[childKey]}\r\n              onChange={(val) => onFilterChange(childKey, val)}\r\n              isNested={true}\r\n            />\r\n          );\r\n        }\r\n\r\n        if (childConfig.type === \"range\") {\r\n          return (\r\n            <RangeFilter\r\n              key={childKey}\r\n              config={childConfig}\r\n              value={filters[childKey]}\r\n              onChange={(val) => onFilterChange(childKey, val)}\r\n              isNested={true}\r\n            />\r\n          );\r\n        }\r\n\r\n        return null;\r\n      })}\r\n    </FilterSection>\r\n  );\r\n};\r\n\r\nexport const FilterBadges = ({ schema, filters, onRemove }) => {\r\n  const badges = useMemo(() => {\r\n    const result = [];\r\n\r\n    const extractBadges = (schemaObj) => {\r\n      Object.entries(schemaObj).forEach(([key, config]) => {\r\n        if (config.type === \"group\" && config.childrenSchema) {\r\n          extractBadges(config.childrenSchema);\r\n          return;\r\n        }\r\n\r\n        const value = filters[key];\r\n        if (!value) return;\r\n\r\n        if (config.type === \"search\") {\r\n          result.push({ key, label: value, type: \"search\" });\r\n        } else if (config.type === \"checkbox\" && value === true) {\r\n          result.push({ key, label: config.label, type: \"checkbox\" });\r\n        } else if (Array.isArray(value) && value.length > 0) {\r\n          value.forEach(val => result.push({ key, label: val, type: \"array\", value: val }));\r\n        }\r\n      });\r\n    };\r\n\r\n    extractBadges(schema);\r\n    return result;\r\n  }, [schema, filters]);\r\n\r\n  if (!badges.length) return null;\r\n\r\n  return (\r\n    <div className=\"flex flex-wrap gap-2 mt-3\">\r\n      {badges.map(badge => (\r\n        <span key={`${badge.key}-${badge.value || ''}`} className=\"inline-flex items-center gap-1.5 px-2 py-1 bg-primary-100/80 text-gray-700 text-sm border\">\r\n          <span>{badge.label}</span>\r\n          <button onClick={() => onRemove(badge)} className=\"hover:text-primary-600 rounded-full p-0.5 transition-colors\">\r\n            <X className=\"w-3.5 h-3.5\" />\r\n          </button>\r\n        </span>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const SearchHeader = ({ schema, filters, onFilterChange }) => {\r\n  const searchConfigEntry = Object.entries(schema).find(([_, c]) => c.type === \"search\");\r\n  if (!searchConfigEntry) return null;\r\n\r\n  const [searchKey, searchSchema] = searchConfigEntry;\r\n  const searchValue = filters[searchKey] || \"\";\r\n\r\n  const removeBadge = (badge) => {\r\n    if (badge.type === \"search\") onFilterChange(badge.key, \"\");\r\n    else if (badge.type === \"array\") {\r\n      const newValues = (filters[badge.key] || []).filter(v => v !== badge.value);\r\n      onFilterChange(badge.key, newValues.length ? newValues : undefined);\r\n    } else if (badge.type === \"checkbox\") {\r\n      onFilterChange(badge.key, undefined);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"mb-6\">\r\n      <div className=\"relative\">\r\n        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400\" />\r\n        <input\r\n          type=\"text\"\r\n          placeholder={searchSchema.placeholder}\r\n          value={searchValue}\r\n          onChange={(e) => onFilterChange(searchKey, e.target.value)}\r\n          className=\"w-full pl-10 pr-10 py-3 border border-gray-400/70 focus:ring-1 focus:ring-primary-500 focus:border-transparent outline-none text-sm\"\r\n        />\r\n        {searchValue && (\r\n          <button onClick={() => onFilterChange(searchKey, \"\")} className=\"absolute right-3 top-1/2 -translate-y-1/2\">\r\n            <X className=\"w-4 h-4 text-gray-400 hover:text-gray-600\" />\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      <FilterBadges schema={schema} filters={filters} onRemove={removeBadge} />\r\n    </div>\r\n  );\r\n};","import React from 'react';\r\nimport { ChevronDown, SlidersHorizontal } from 'lucide-react';\r\nimport { CheckboxFilter, CheckboxGroupFilter, NestedGroupFilter, RangeFilter } from \"./FilterItem\";\r\n\r\nexport const FilterPanel = ({ schema, filters, onFilterChange }) => {\r\n  const [generalExpanded, setGeneralExpanded] = React.useState(true);\r\n\r\n  const renderFilter = (key, config) => {\r\n    if (config.type === \"search\") return null;\r\n\r\n    if (config.type === \"group\") {\r\n      return (\r\n        <NestedGroupFilter\r\n          key={key}\r\n          config={config}\r\n          filters={filters}\r\n          onFilterChange={onFilterChange}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (config.type === \"checkbox-group\") {\r\n      return (\r\n        <CheckboxGroupFilter\r\n          key={key}\r\n          config={config}\r\n          value={filters[key]}\r\n          onChange={(value) => onFilterChange(key, value)}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (config.type === \"range\") {\r\n      return (\r\n        <RangeFilter\r\n          key={key}\r\n          config={config}\r\n          value={filters[key]}\r\n          onChange={(value) => onFilterChange(key, value)}\r\n        />\r\n      );\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  const standaloneCheckboxes = Object.entries(schema).filter(\r\n    ([, config]) => config.type === \"checkbox\"\r\n  );\r\n\r\n  return (\r\n    <div className=\"w-72 bg-white border-r border-gray-200 h-screen overflow-y-auto p-6 sticky top-0 custom-scroll\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center gap-2 mb-6\">\r\n        <SlidersHorizontal className=\"w-5 h-5 text-primary-600\" />\r\n        <h2 className=\"text-lg font-semibold text-gray-900 tracking-tight\">Filters</h2>\r\n      </div>\r\n\r\n      {/* General group for standalone checkboxes */}\r\n      {standaloneCheckboxes.length > 0 && (\r\n        <div className=\"pb-3 mb-3 border-b border-gray-200\">\r\n          <button\r\n            onClick={() => setGeneralExpanded(!generalExpanded)}\r\n            className=\"w-full flex items-center justify-between group\"\r\n          >\r\n            <h3 className=\"text-[13px] font-semibold text-gray-800 tracking-wide uppercase\">\r\n              General\r\n            </h3>\r\n            <ChevronDown \r\n              className={`w-5 h-5 text-gray-600 hover:text-primary-600 transition-transform ${generalExpanded ? 'rotate-180' : ''}`} \r\n            />\r\n          </button>\r\n\r\n          {generalExpanded && (\r\n            <div className=\"space-y-0.5 mt-2\">\r\n              {standaloneCheckboxes.map(([key, config]) => (\r\n                <CheckboxFilter\r\n                  key={key}\r\n                  config={config}\r\n                  value={filters[key]}\r\n                  onChange={(val) => onFilterChange(key, val)}\r\n                />\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {Object.entries(schema).map(([key, config]) => renderFilter(key, config))}\r\n    </div>\r\n  );\r\n};\r\n","export const getNestedValue = (obj, path) => {\r\n  if (!obj || !path) return null;\r\n  return path.split('.').reduce((acc, key) => (acc != null ? acc[key] : null), obj);\r\n};\r\n\r\nexport const cleanFilters = (filters) => {\r\n  return Object.fromEntries(\r\n    Object.entries(filters).filter(\r\n      ([, value]) =>\r\n        value !== undefined &&\r\n        value !== null &&\r\n        value !== \"\" &&\r\n        !(Array.isArray(value) && value.length === 0) &&\r\n        value !== false\r\n    )\r\n  );\r\n};\r\n\r\nexport const encodeFilters = (filters) => {\r\n  try {\r\n    const cleaned = cleanFilters(filters);\r\n    return Object.keys(cleaned).length ? btoa(encodeURIComponent(JSON.stringify(cleaned))) : \"\";\r\n  } catch {\r\n    return \"\";\r\n  }\r\n};\r\n\r\nexport const decodeFilters = (encoded) => {\r\n  try {\r\n    return JSON.parse(decodeURIComponent(atob(encoded)));\r\n  } catch {\r\n    return {};\r\n  }\r\n};\r\n\r\nexport const flattenSchema = (schema) => {\r\n  const flat = {};\r\n  let search = null;\r\n\r\n  const helper = (obj) => {\r\n    // Guard: Ensure obj is an object before calling Object.entries\r\n    if (!obj || typeof obj !== 'object') return;\r\n    \r\n    Object.entries(obj).forEach(([key, config]) => {\r\n      if (!config) return;\r\n\r\n      const type = String(config.type).toLowerCase();\r\n      if (type === \"group\" && config.childrenSchema) {\r\n        helper(config.childrenSchema);\r\n      } else if (type === \"search\") {\r\n        search = { key, config };\r\n      } else {\r\n        flat[key] = config;\r\n      }\r\n    });\r\n  };\r\n\r\n  helper(schema);\r\n  return { flat, search };\r\n};\r\n\r\nconst handlers = {\r\n  \"checkbox-group\": (itemValue, filterValue, config) => {\r\n    if (config.transform && itemValue != null) itemValue = config.transform(itemValue);\r\n    const itemArray = Array.isArray(itemValue) ? itemValue : [itemValue];\r\n    const selected = Array.isArray(filterValue) ? filterValue : [filterValue];\r\n\r\n    const normalizedItem = itemArray.map(v => v ? String(v).toLowerCase() : v);\r\n    const normalizedSelected = selected.map(v => v ? String(v).toLowerCase() : v);\r\n\r\n    if (normalizedSelected.includes(\"other\") && config.options) {\r\n      const optionsLower = config.options.map(o => o.toLowerCase());\r\n      if (normalizedItem.some(v => v && !optionsLower.includes(v))) return true;\r\n    }\r\n\r\n    return normalizedSelected.some(v => normalizedItem.includes(v));\r\n  },\r\n\r\n  range: (itemValue, filterValue, config) => {\r\n    const num = Number(itemValue);\r\n    if (isNaN(num)) return false;\r\n    return filterValue.some(label => {\r\n      const range = config.ranges?.find(r => r.label === label);\r\n      return range ? num >= range.min && num <= range.max : false;\r\n    });\r\n  },\r\n\r\n  checkbox: (itemValue, filterValue) => filterValue ? !!itemValue : true\r\n};\r\n\r\nexport const applyFilters = (data, filters, schema) => {\r\n  // Guard: Ensure data is an array\r\n  if (!Array.isArray(data)) return [];\r\n  if (!data.length) return [];\r\n  if (!filters || !Object.keys(filters).length) return data;\r\n\r\n  const { flat, search } = flattenSchema(schema);\r\n\r\n  return data.filter(item => {\r\n    if (search && filters[search.key]?.trim()) {\r\n      const term = filters[search.key].toLowerCase();\r\n      const fields = Array.isArray(search.config.fields) ? search.config.fields : [search.config.field];\r\n      const matches = fields.some(f => {\r\n        const val = getNestedValue(item, f);\r\n        if (Array.isArray(val)) return val.some(v => String(v || \"\").toLowerCase().includes(term));\r\n        return String(val || \"\").toLowerCase().includes(term);\r\n      });\r\n      if (!matches) return false;\r\n    }\r\n\r\n    return Object.entries(filters).every(([key, value]) => {\r\n      if (search && key === search.key) return true; \r\n      if (!value || (Array.isArray(value) && !value.length)) return true;\r\n\r\n      const config = flat[key];\r\n      if (!config) return true;\r\n\r\n      let itemValue = getNestedValue(item, config.field);\r\n      const handler = handlers[config.type];\r\n      return handler ? handler(itemValue, value, config) : true;\r\n    });\r\n  });\r\n};\r\n\r\nexport const extractDynamicOptions = (data, schema) => {\r\n  // CRITICAL Guard: Ensure data is an array at the very start\r\n  if (!data || !Array.isArray(data)) {\r\n    console.warn('extractDynamicOptions: data must be an array, received:', typeof data);\r\n    return {};\r\n  }\r\n  \r\n  if (!data.length) return {};\r\n  \r\n  const { flat } = flattenSchema(schema);\r\n  const options = {};\r\n\r\n  // Guard: Ensure flat is an object\r\n  if (!flat || typeof flat !== 'object') return {};\r\n\r\n  Object.entries(flat).forEach(([key, config]) => {\r\n    if (!config) return;\r\n    if (config.options?.length) return;\r\n    if (!['checkbox-group', 'checkbox'].includes(config.type)) return;\r\n\r\n    const set = new Set();\r\n    \r\n    // Additional guard: Double-check data is still an array before forEach\r\n    if (Array.isArray(data)) {\r\n      data.forEach(item => {\r\n        let val = getNestedValue(item, config.field);\r\n        if (config.transform && val != null) val = config.transform(val);\r\n\r\n        if (config.isArray && Array.isArray(val)) {\r\n          val.forEach(v => v != null && set.add(String(v)));\r\n        } else if (val != null) {\r\n          set.add(String(val));\r\n        }\r\n      });\r\n    }\r\n\r\n    options[key] = Array.from(set).sort();\r\n  });\r\n\r\n  return options;\r\n};\r\n\r\nexport const updateSchemaWithDynamicOptions = (schema, data) => {\r\n  // CRITICAL Guard: Ensure data is an array before any operations\r\n  if (!data || !Array.isArray(data)) {\r\n    console.warn('updateSchemaWithDynamicOptions: data must be an array, received:', typeof data);\r\n    data = [];\r\n  }\r\n  \r\n  // Pass data and schema in correct order\r\n  const dynamicOptions = extractDynamicOptions(data, schema);\r\n\r\n  const update = (obj) => {\r\n    // Guard: Ensure obj is an object\r\n    if (!obj || typeof obj !== 'object') return {};\r\n    \r\n    return Object.fromEntries(\r\n      Object.entries(obj).map(([key, config]) => {\r\n        if (!config) return [key, config];\r\n        const newConfig = { ...config };\r\n\r\n        if (config.type === \"group\" && config.childrenSchema) {\r\n          newConfig.childrenSchema = update(config.childrenSchema);\r\n        } else if (dynamicOptions[key]?.length) {\r\n          newConfig.options = dynamicOptions[key];\r\n        }\r\n\r\n        return [key, newConfig];\r\n      })\r\n    );\r\n  };\r\n\r\n  return update(schema);\r\n};","\"use client\";\r\n\r\nimport React, { useState, useEffect, useMemo, useCallback } from \"react\";\r\nimport { FilterPanel } from \"./FilterPanel\";\r\nimport { SearchHeader } from \"./FilterItem\";\r\nimport {\r\n  applyFilters,\r\n  updateSchemaWithDynamicOptions,\r\n  decodeFilters,\r\n  encodeFilters,\r\n} from \"./FilterUtils\";\r\nimport { Loader2 } from \"lucide-react\";\r\n\r\nexport const DatasetFilter = ({\r\n  schema,\r\n  data, // can be array, URL string, or async function\r\n  renderContent,\r\n  enableUrlSync = true,\r\n  className = \"\",\r\n}) => {\r\n  const [filters, setFilters] = useState({});\r\n  const [sourceData, setSourceData] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // ------------------ Load data ------------------\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      setLoading(true);\r\n      setError(null);\r\n      try {\r\n        let result;\r\n\r\n        if (Array.isArray(data)) {\r\n          result = data;\r\n        } else if (typeof data === \"string\") {\r\n          // Treat as URL\r\n          const res = await fetch(data);\r\n          if (!res.ok) {\r\n            throw new Error(`Failed to fetch: ${res.status} ${res.statusText}`);\r\n          }\r\n          result = await res.json();\r\n        } else if (typeof data === \"function\") {\r\n          // Async function\r\n          result = await data();\r\n        } else {\r\n          console.warn(\r\n            \"DatasetFilter: data must be array, URL string, or async function\"\r\n          );\r\n          result = [];\r\n        }\r\n\r\n        // Ensure result is array and update state\r\n        const arrayResult = Array.isArray(result) ? result : [];\r\n        setSourceData(arrayResult);\r\n      } catch (err) {\r\n        console.error(\"DatasetFilter error:\", err);\r\n        setError(err);\r\n        setSourceData([]); // Always set empty array on error\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n  }, [data]);\r\n\r\n  // ------------------ Filters ------------------\r\n  const updateFilter = useCallback((key, value) => {\r\n    setFilters((prev) => {\r\n      const newFilters = { ...prev };\r\n      if (\r\n        value === undefined ||\r\n        value === null ||\r\n        value === \"\" ||\r\n        (Array.isArray(value) && value.length === 0) ||\r\n        value === false\r\n      ) {\r\n        delete newFilters[key];\r\n      } else {\r\n        newFilters[key] = value;\r\n      }\r\n      return newFilters;\r\n    });\r\n  }, []);\r\n\r\n  // ------------------ URL Sync ------------------\r\n  useEffect(() => {\r\n    if (!enableUrlSync) return;\r\n    \r\n    try {\r\n      const params = new URLSearchParams(window.location.search);\r\n      const encoded = params.get(\"f\");\r\n      if (encoded) {\r\n        const decoded = decodeFilters(encoded);\r\n        if (Object.keys(decoded).length > 0) {\r\n          setFilters(decoded);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Failed to decode filters from URL:\", err);\r\n    }\r\n  }, [enableUrlSync]);\r\n\r\n  useEffect(() => {\r\n    if (!enableUrlSync) return;\r\n    \r\n    try {\r\n      const encoded = encodeFilters(filters);\r\n      if (!encoded) {\r\n        window.history.replaceState({}, \"\", window.location.pathname);\r\n        return;\r\n      }\r\n      const params = new URLSearchParams();\r\n      params.set(\"f\", encoded);\r\n      window.history.replaceState({}, \"\", `?${params.toString()}`);\r\n    } catch (err) {\r\n      console.error(\"Failed to encode filters to URL:\", err);\r\n    }\r\n  }, [filters, enableUrlSync]);\r\n\r\n  // ------------------ Schema & Filtering ------------------\r\n  // Always ensure we pass arrays to these functions\r\n  const updatedSchema = useMemo(() => {\r\n    const safeData = Array.isArray(sourceData) ? sourceData : [];\r\n    return updateSchemaWithDynamicOptions(schema, safeData);\r\n  }, [schema, sourceData]);\r\n\r\n  const filteredData = useMemo(() => {\r\n    const safeData = Array.isArray(sourceData) ? sourceData : [];\r\n    return applyFilters(safeData, filters, updatedSchema);\r\n  }, [sourceData, filters, updatedSchema]);\r\n\r\n  // ------------------ Loading / Error ------------------\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <Loader2 className=\"w-8 h-8 animate-spin text-blue-600 mx-auto mb-2\" />\r\n          <p className=\"text-gray-600\">Loading data...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <div className=\"text-red-600 mb-4\">\r\n            <p className=\"font-semibold text-lg mb-2\">Error loading data</p>\r\n            <p className=\"text-sm\">{error.message}</p>\r\n          </div>\r\n          <button\r\n            onClick={() => window.location.reload()}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors\"\r\n          >\r\n            Retry\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // ------------------ Render ------------------\r\n  return (\r\n    <div className={`flex min-h-screen bg-gray-50 ${className}`}>\r\n      <FilterPanel\r\n        schema={updatedSchema}\r\n        filters={filters}\r\n        onFilterChange={updateFilter}\r\n      />\r\n\r\n      <div className=\"flex-1 p-8\">\r\n        <div className=\"max-w-5xl mx-auto\">\r\n          <SearchHeader\r\n            schema={updatedSchema}\r\n            filters={filters}\r\n            onFilterChange={updateFilter}\r\n            onRemoveFilter={updateFilter}\r\n          />\r\n\r\n          {renderContent &&\r\n            renderContent({\r\n              filteredData,\r\n              totalData: sourceData,\r\n              filters,\r\n            })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};","import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\r\nimport { DatasetFilter as OriginalDatasetFilter } from \"./DatasetFilter\";\r\n\r\nconst defaultQueryClient = new QueryClient();\r\n\r\nexport const DatasetFilter = (props) => (\r\n  <QueryClientProvider client={defaultQueryClient}>\r\n    <OriginalDatasetFilter {...props} />\r\n  </QueryClientProvider>\r\n);\r\n"],"names":["FilterSection","label","isNested","children","defaultExpanded","isExpanded","setIsExpanded","useState","_jsxs","className","onClick","_jsx","ChevronDown","CheckboxItem","checked","onChange","type","CheckboxGroupFilter","config","value","showAll","setShowAll","toggleOption","useCallback","option","newValue","includes","filter","v","length","undefined","options","visibleOptions","slice","map","RangeFilter","_config$ranges","toggleRange","ranges","range","CheckboxFilter","e","target","NestedGroupFilter","filters","onFilterChange","childKey","childConfig","childrenSchema","val","FilterBadges","schema","onRemove","badges","useMemo","result","extractBadges","schemaObj","Object","entries","forEach","key","push","Array","isArray","badge","X","SearchHeader","searchConfigEntry","find","_","c","searchKey","searchSchema","searchValue","Search","placeholder","newValues","FilterPanel","generalExpanded","setGeneralExpanded","React","standaloneCheckboxes","SlidersHorizontal","renderFilter","getNestedValue","obj","path","split","reduce","acc","encodeFilters","cleaned","fromEntries","cleanFilters","keys","btoa","encodeURIComponent","JSON","stringify","flattenSchema","flat","search","helper","String","toLowerCase","handlers","checkbox-group","itemValue","filterValue","transform","itemArray","selected","normalizedItem","normalizedSelected","optionsLower","o","some","num","Number","isNaN","r","min","max","checkbox","updateSchemaWithDynamicOptions","data","console","warn","dynamicOptions","extractDynamicOptions","_config$options","set","Set","item","field","add","from","sort","update","_dynamicOptions$key","newConfig","DatasetFilter","renderContent","enableUrlSync","setFilters","sourceData","setSourceData","loading","setLoading","error","setError","useEffect","async","res","fetch","ok","Error","status","statusText","json","arrayResult","err","loadData","updateFilter","prev","newFilters","encoded","URLSearchParams","window","location","get","decoded","parse","decodeURIComponent","atob","decodeFilters","history","replaceState","pathname","params","toString","updatedSchema","safeData","filteredData","applyFilters","_filters$search$key","trim","term","fields","f","every","handler","Loader2","message","reload","onRemoveFilter","totalData","defaultQueryClient","QueryClient","props","QueryClientProvider","client","OriginalDatasetFilter"],"mappings":"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"}