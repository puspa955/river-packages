{"version":3,"file":"index.js","sources":["../src/FilterSection.js","../src/FilterItem.js","../src/FilterPanel.js","../src/FilterUtils.js","../src/DatasetFilter.js","../src/index.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { ChevronDown } from \"lucide-react\";\r\n\r\nexport const FilterSection = ({ label, isNested = false, children, defaultExpanded = true }) => {\r\n  const [isExpanded, setIsExpanded] = useState(defaultExpanded);\r\n\r\n  const HeadingTag = isNested ? 'h4' : 'h3';\r\n  const headingClass = isNested\r\n    ? \"text-xs font-medium text-gray-700 pb-2\"\r\n    : \"text-[13px] font-semibold text-gray-800 tracking-wide uppercase pb-2\";\r\n\r\n  const containerClass = isNested ? \"\" : \" mb-3 border-b border-gray-200\";\r\n\r\n  return (\r\n    <div className={containerClass}>\r\n      <button\r\n        onClick={() => setIsExpanded(!isExpanded)}\r\n        className=\"w-full flex justify-between group\"\r\n      >\r\n        <HeadingTag className={headingClass}>{label}</HeadingTag>\r\n        <ChevronDown className={`w-5 h-5 text-gray-600 hover:text-primary-600 transition-transform ${isExpanded ? 'rotate-180' : ''}`} />\r\n      </button>\r\n\r\n      {isExpanded && <div className=\"mb-3 space-y-0.5\">{children}</div>}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useCallback, useMemo, useState } from 'react';\r\nimport { ChevronDown, Search, SlidersHorizontal, X } from 'lucide-react';\r\nimport { FilterSection } from './FilterSection';\r\n\r\n/* ------------------------------ SHARED CHECKBOX COMPONENT ------------------------------ */\r\nexport const CheckboxItem = ({ checked, onChange, label }) => {\r\n  return (\r\n    <label className=\"flex items-start gap-3 cursor-pointer group w-fit\">\r\n      <input\r\n        type=\"checkbox\"\r\n        checked={checked}\r\n        onChange={onChange}\r\n        className=\"mt-0.5 w-4 h-4 rounded-sm border-gray-300 accent-primary-600 focus:ring-primary-500 cursor-pointer transition-colors group-hover:border-primary-600\"\r\n      />\r\n      <span className=\"text-sm text-gray-900 font-light group-hover:text-primary-600 transition-colors\">\r\n        {label}\r\n      </span>\r\n    </label>\r\n  );\r\n};\r\n\r\nexport const CheckboxGroupFilter = ({ config = {}, value = [], onChange, isNested = false }) => {\r\n  const [showAll, setShowAll] = useState(false);\r\n  \r\n  const toggleOption = useCallback((option) => {\r\n    const newValue = value.includes(option) ? value.filter(v => v !== option) : [...value, option];\r\n    onChange(newValue.length ? newValue : undefined);\r\n  }, [value, onChange]);\r\n\r\n  if (!config.options || config.options.length === 0) return null;\r\n\r\n  const MAX_VISIBLE = 5;\r\n  const visibleOptions = showAll ? config.options : config.options.slice(0, MAX_VISIBLE);\r\n\r\n  return (\r\n    <FilterSection label={config.label} isNested={isNested}>\r\n      {visibleOptions.map(option => (\r\n        <CheckboxItem\r\n          key={option}\r\n          label={option}\r\n          checked={value?.includes(option) || false}\r\n          onChange={() => toggleOption(option)}\r\n        />\r\n      ))}\r\n\r\n      {config.options.length > MAX_VISIBLE && (\r\n        <button\r\n          onClick={() => setShowAll(!showAll)}\r\n          className=\"mt-2 text-primary-600 hover:text-primary-500 text-xs inline-flex items-center gap-1 underline\"\r\n        >\r\n          {showAll ? 'See less' : 'See all'}\r\n        </button>\r\n      )}\r\n    </FilterSection>\r\n  );\r\n};\r\n\r\n\r\n/* ------------------------------ RANGE FILTER ------------------------------ */\r\nexport const RangeFilter = ({ config, value = [], onChange, isNested = false }) => {\r\n  const toggleRange = useCallback((label) => {\r\n    const newValue = value.includes(label) ? value.filter(v => v !== label) : [...value, label];\r\n    onChange(newValue.length ? newValue : undefined);\r\n  }, [value, onChange]);\r\n\r\n  if (!config.ranges?.length) return null;\r\n\r\n  return (\r\n    <FilterSection label={config.label} isNested={isNested}>\r\n      {config.ranges.map(range => (\r\n        <CheckboxItem\r\n          key={range.label}\r\n          label={range.label}\r\n          checked={value?.includes(range.label) || false}\r\n          onChange={() => toggleRange(range.label)}\r\n        />\r\n      ))}\r\n    </FilterSection>\r\n  );\r\n};\r\n\r\n/* ------------------------------ STANDALONE CHECKBOX ------------------------------ */\r\nexport const CheckboxFilter = ({ config, value = false, onChange }) => {\r\n  return (\r\n    <div>\r\n      <CheckboxItem\r\n        checked={!!value}\r\n        onChange={(e) => onChange(e.target.checked ? true : undefined)}\r\n        label={config.label}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\n/* ------------------------------ NESTED GROUP FILTER ------------------------------ */\r\nexport const NestedGroupFilter = ({ config, filters, onFilterChange, defaultExpanded = true }) => {\r\n  if (!config.children || config.children.length === 0) return null;\r\n\r\n  return (\r\n    <FilterSection label={config.label} defaultExpanded={defaultExpanded}>\r\n      {config.children.map(childKey => {\r\n        const childConfig = config.childrenSchema[childKey];\r\n        if (!childConfig) return null;\r\n\r\n        if (childConfig.type === \"checkbox-group\") {\r\n          return (\r\n            <CheckboxGroupFilter\r\n              key={childKey}\r\n              config={childConfig}\r\n              value={filters[childKey]}\r\n              onChange={(val) => onFilterChange(childKey, val)}\r\n              isNested={true}\r\n            />\r\n          );\r\n        }\r\n\r\n        if (childConfig.type === \"range\") {\r\n          return (\r\n            <RangeFilter\r\n              key={childKey}\r\n              config={childConfig}\r\n              value={filters[childKey]}\r\n              onChange={(val) => onFilterChange(childKey, val)}\r\n              isNested={true}\r\n            />\r\n          );\r\n        }\r\n\r\n        return null;\r\n      })}\r\n    </FilterSection>\r\n  );\r\n};\r\n\r\nexport const FilterBadges = ({ schema, filters, onRemove }) => {\r\n  const badges = useMemo(() => {\r\n    const result = [];\r\n\r\n    const extractBadges = (schemaObj) => {\r\n      Object.entries(schemaObj).forEach(([key, config]) => {\r\n        if (config.type === \"group\" && config.childrenSchema) {\r\n          extractBadges(config.childrenSchema);\r\n          return;\r\n        }\r\n\r\n        const value = filters[key];\r\n        if (!value) return;\r\n\r\n        if (config.type === \"search\") {\r\n          result.push({ key, label: value, type: \"search\" });\r\n        } else if (config.type === \"checkbox\" && value === true) {\r\n          result.push({ key, label: config.label, type: \"checkbox\" });\r\n        } else if (Array.isArray(value) && value.length > 0) {\r\n          value.forEach(val => result.push({ key, label: val, type: \"array\", value: val }));\r\n        }\r\n      });\r\n    };\r\n\r\n    extractBadges(schema);\r\n    return result;\r\n  }, [schema, filters]);\r\n\r\n  if (!badges.length) return null;\r\n\r\n  return (\r\n    <div className=\"flex flex-wrap gap-2 mt-3\">\r\n      {badges.map(badge => (\r\n        <span key={`${badge.key}-${badge.value || ''}`} className=\"inline-flex items-center gap-1.5 px-2 py-1 bg-primary-100/80 text-gray-700 text-sm border\">\r\n          <span>{badge.label}</span>\r\n          <button onClick={() => onRemove(badge)} className=\"hover:text-primary-600 rounded-full p-0.5 transition-colors\">\r\n            <X className=\"w-3.5 h-3.5\" />\r\n          </button>\r\n        </span>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\n/* ------------------------------ SEARCH HEADER ------------------------------ */\r\nexport const SearchHeader = ({ schema, filters, onFilterChange }) => {\r\n  const searchConfigEntry = Object.entries(schema).find(([_, c]) => c.type === \"search\");\r\n  if (!searchConfigEntry) return null;\r\n\r\n  const [searchKey, searchSchema] = searchConfigEntry;\r\n  const searchValue = filters[searchKey] || \"\";\r\n\r\n  const removeBadge = (badge) => {\r\n    if (badge.type === \"search\") onFilterChange(badge.key, \"\");\r\n    else if (badge.type === \"array\") {\r\n      const newValues = (filters[badge.key] || []).filter(v => v !== badge.value);\r\n      onFilterChange(badge.key, newValues.length ? newValues : undefined);\r\n    } else if (badge.type === \"checkbox\") {\r\n      onFilterChange(badge.key, undefined);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"mb-6\">\r\n      <div className=\"relative\">\r\n        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400\" />\r\n        <input\r\n          type=\"text\"\r\n          placeholder={searchSchema.placeholder}\r\n          value={searchValue}\r\n          onChange={(e) => onFilterChange(searchKey, e.target.value)}\r\n          className=\"w-full pl-10 pr-10 py-3 border border-gray-400/70 focus:ring-1 focus:ring-primary-500 focus:border-transparent outline-none text-sm\"\r\n        />\r\n        {searchValue && (\r\n          <button onClick={() => onFilterChange(searchKey, \"\")} className=\"absolute right-3 top-1/2 -translate-y-1/2\">\r\n            <X className=\"w-4 h-4 text-gray-400 hover:text-gray-600\" />\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      <FilterBadges schema={schema} filters={filters} onRemove={removeBadge} />\r\n    </div>\r\n  );\r\n};","import React from 'react';\r\nimport { ChevronDown, SlidersHorizontal } from 'lucide-react';\r\nimport { CheckboxFilter, CheckboxGroupFilter, NestedGroupFilter, RangeFilter } from \"./FilterItem\";\r\n\r\nexport const FilterPanel = ({ schema, filters, onFilterChange }) => {\r\n  const [generalExpanded, setGeneralExpanded] = React.useState(true);\r\n\r\n  const renderFilter = (key, config) => {\r\n    if (config.type === \"search\") return null;\r\n\r\n    if (config.type === \"group\") {\r\n      return (\r\n        <NestedGroupFilter\r\n          key={key}\r\n          config={config}\r\n          filters={filters}\r\n          onFilterChange={onFilterChange}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (config.type === \"checkbox-group\") {\r\n      return (\r\n        <CheckboxGroupFilter\r\n          key={key}\r\n          config={config}\r\n          value={filters[key]}\r\n          onChange={(value) => onFilterChange(key, value)}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (config.type === \"range\") {\r\n      return (\r\n        <RangeFilter\r\n          key={key}\r\n          config={config}\r\n          value={filters[key]}\r\n          onChange={(value) => onFilterChange(key, value)}\r\n        />\r\n      );\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  // Standalone checkboxes (type === \"checkbox\")\r\n  const standaloneCheckboxes = Object.entries(schema).filter(\r\n    ([, config]) => config.type === \"checkbox\"\r\n  );\r\n\r\n  return (\r\n    <div className=\"w-72 bg-white border-r border-gray-200 h-screen overflow-y-auto p-6 sticky top-0 custom-scroll\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center gap-2 mb-6\">\r\n        <SlidersHorizontal className=\"w-5 h-5 text-primary-600\" />\r\n        <h2 className=\"text-lg font-semibold text-gray-900 tracking-tight\">Filters</h2>\r\n      </div>\r\n\r\n      {/* General group for standalone checkboxes */}\r\n      {standaloneCheckboxes.length > 0 && (\r\n        <div className=\"pb-3 mb-3 border-b border-gray-200\">\r\n          <button\r\n            onClick={() => setGeneralExpanded(!generalExpanded)}\r\n            className=\"w-full flex items-center justify-between group\"\r\n          >\r\n            <h3 className=\"text-[13px] font-semibold text-gray-800 tracking-wide uppercase\">\r\n              General\r\n            </h3>\r\n            <ChevronDown \r\n              className={`w-5 h-5 text-gray-600 hover:text-primary-600 transition-transform ${generalExpanded ? 'rotate-180' : ''}`} \r\n            />\r\n          </button>\r\n\r\n          {generalExpanded && (\r\n            <div className=\"space-y-0.5 mt-2\">\r\n              {standaloneCheckboxes.map(([key, config]) => (\r\n                <CheckboxFilter\r\n                  key={key}\r\n                  config={config}\r\n                  value={filters[key]}\r\n                  onChange={(val) => onFilterChange(key, val)}\r\n                />\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* All other filters */}\r\n      {Object.entries(schema).map(([key, config]) => renderFilter(key, config))}\r\n    </div>\r\n  );\r\n};\r\n","export const getNestedValue = (obj, path) => {\r\n  if (!path || !obj) return null;\r\n  return path.split('.').reduce((acc, part) => {\r\n    if (acc === null || acc === undefined) return null;\r\n    return acc[part];\r\n  }, obj);\r\n};\r\n\r\n\r\nexport const applyFilters = (data, filters, schema) => {\r\n  if (!data || !Array.isArray(data)) return [];\r\n  if (!filters || Object.keys(filters).length === 0) return data;\r\n  \r\n  const flatSchema = {};\r\n  let searchConfig = null;\r\n  let searchKey = null;\r\n  \r\n  const flattenSchema = (schemaObj) => {\r\n    if (!schemaObj) return;\r\n    \r\n    Object.entries(schemaObj).forEach(([key, config]) => {\r\n      if (!config) return;\r\n      \r\n      // Use string comparison with type coercion to handle bundling issues\r\n      const configType = String(config.type).toLowerCase().trim();\r\n      \r\n      if (configType === \"group\" && config.childrenSchema) {\r\n        Object.entries(config.childrenSchema).forEach(([childKey, childConfig]) => {\r\n          flatSchema[childKey] = childConfig;\r\n        });\r\n      } else if (configType === \"search\") {\r\n        // Store search config instead of excluding it\r\n        searchConfig = config;\r\n        searchKey = key;\r\n      } else {\r\n        flatSchema[key] = config;\r\n      }\r\n    });\r\n  };\r\n\r\n  flattenSchema(schema);\r\n\r\n  return data.filter(item => {\r\n    // Handle search filter first\r\n    if (searchConfig && searchKey && filters[searchKey]) {\r\n      const searchTerm = filters[searchKey];\r\n      if (searchTerm && searchTerm.trim()) {\r\n        const fields = Array.isArray(searchConfig.fields) ? searchConfig.fields : [searchConfig.field];\r\n        const matchesSearch = fields.some(field => {\r\n          const value = getNestedValue(item, field);\r\n          \r\n          // Handle array values (like features in products)\r\n          if (Array.isArray(value)) {\r\n            return value.some(v => \r\n              String(v || '').toLowerCase().includes(searchTerm.toLowerCase())\r\n            );\r\n          }\r\n          \r\n          // Handle regular values\r\n          return String(value || '').toLowerCase().includes(searchTerm.toLowerCase());\r\n        });\r\n        \r\n        if (!matchesSearch) return false;\r\n      }\r\n    }\r\n\r\n    // Handle other filters\r\n    return Object.entries(filters).every(([filterKey, filterValue]) => {\r\n      // Skip search key since we already handled it above\r\n      if (searchKey && filterKey === searchKey) return true;\r\n      \r\n      if (!filterValue || (Array.isArray(filterValue) && filterValue.length === 0)) return true;\r\n\r\n      const config = flatSchema[filterKey];\r\n      if (!config) return true;\r\n\r\n      let itemValue = getNestedValue(item, config.field);\r\n\r\n      switch (config.type) {\r\n        case 'checkbox-group': {\r\n          if (config.transform && itemValue !== null && itemValue !== undefined) {\r\n            itemValue = config.transform(itemValue);\r\n          }\r\n\r\n          const itemArray = Array.isArray(itemValue) ? itemValue : [itemValue];\r\n          const selected = Array.isArray(filterValue) ? filterValue : [filterValue];\r\n\r\n          const normalizedItemArray = itemArray.map(val => \r\n            val ? String(val).toLowerCase() : val\r\n          );\r\n          const normalizedSelected = selected.map(val => \r\n            val ? String(val).toLowerCase() : val\r\n          );\r\n\r\n          if (normalizedSelected.includes('other') && config.options) {\r\n            const normalizedOptions = config.options.map(opt => opt.toLowerCase());\r\n            const otherSelected = normalizedItemArray.some(\r\n              val => val && !normalizedOptions.includes(val)\r\n            );\r\n            if (otherSelected) return true;\r\n          }\r\n\r\n          return normalizedSelected.some(val => normalizedItemArray.includes(val));\r\n        }\r\n\r\n        case 'range': {\r\n          const numValue = Number(itemValue);\r\n          if (isNaN(numValue) || itemValue === null || itemValue === undefined) return false;\r\n\r\n          return filterValue.some(label => {\r\n            const range = config.ranges.find(r => r.label === label);\r\n            return range ? numValue >= range.min && numValue <= range.max : false;\r\n          });\r\n        }\r\n\r\n        case 'checkbox': {\r\n          return filterValue ? !!itemValue : true;\r\n        }\r\n\r\n        case 'select': {\r\n          if (!itemValue) return false;\r\n          \r\n          const itemStr = String(itemValue).toLowerCase();\r\n          const filterStr = String(filterValue).toLowerCase();\r\n          \r\n          if (filterStr === 'other' && config.options) {\r\n            const normalizedOptions = config.options.map(opt => opt.toLowerCase());\r\n            return !normalizedOptions.includes(itemStr);\r\n          }\r\n          \r\n          return itemStr === filterStr;\r\n        }\r\n\r\n        default:\r\n          return true;\r\n      }\r\n    });\r\n  });\r\n};\r\n\r\nexport const extractDynamicOptions = (data, schema) => {\r\n  const dynamicOptions = {};\r\n\r\n  const flatSchema = {};\r\n  \r\n  const flattenSchema = (schemaObj) => {\r\n    Object.entries(schemaObj).forEach(([key, config]) => {\r\n      if (config.type === \"group\" && config.childrenSchema) {\r\n        Object.entries(config.childrenSchema).forEach(([childKey, childConfig]) => {\r\n          flatSchema[childKey] = childConfig;\r\n        });\r\n      } else {\r\n        flatSchema[key] = config;\r\n      }\r\n    });\r\n  };\r\n\r\n  flattenSchema(schema);\r\n\r\n  Object.entries(flatSchema).forEach(([key, config]) => {\r\n    if (config.options && config.options.length > 0) return;\r\n    if (!['checkbox-group', 'select', 'checkbox'].includes(config.type)) return;\r\n\r\n    const optionsSet = new Set();\r\n\r\n    data.forEach(item => {\r\n      let value = getNestedValue(item, config.field);\r\n      if (config.transform && value !== null && value !== undefined) {\r\n        value = config.transform(value);\r\n      }\r\n\r\n      if (config.isArray && Array.isArray(value)) {\r\n        value.forEach(v => v !== null && optionsSet.add(String(v)));\r\n      } else if (value !== null && value !== undefined) {\r\n        optionsSet.add(String(value));\r\n      }\r\n    });\r\n\r\n    dynamicOptions[key] = Array.from(optionsSet).sort();\r\n  });\r\n\r\n  return dynamicOptions;\r\n};\r\n\r\nexport const updateSchemaWithDynamicOptions = (schema, data) => {\r\n  const dynamicOptions = extractDynamicOptions(data, schema);\r\n  const updatedSchema = {};\r\n\r\n  Object.entries(schema).forEach(([key, config]) => {\r\n    updatedSchema[key] = { ...config };\r\n    \r\n    if (config.type === \"group\" && config.childrenSchema) {\r\n      updatedSchema[key].childrenSchema = {};\r\n      Object.entries(config.childrenSchema).forEach(([childKey, childConfig]) => {\r\n        updatedSchema[key].childrenSchema[childKey] = { ...childConfig };\r\n        if (dynamicOptions[childKey] && dynamicOptions[childKey].length > 0) {\r\n          updatedSchema[key].childrenSchema[childKey].options = dynamicOptions[childKey];\r\n        }\r\n      });\r\n    } else if (dynamicOptions[key] && dynamicOptions[key].length > 0) {\r\n      updatedSchema[key].options = dynamicOptions[key];\r\n    }\r\n  });\r\n\r\n  return updatedSchema;\r\n};\r\n\r\nexport const cleanFilters = (filters) => {\r\n  const cleaned = {};\r\n  \r\n  Object.entries(filters).forEach(([key, value]) => {\r\n    if (\r\n      value === undefined || \r\n      value === null || \r\n      value === \"\" || \r\n      (Array.isArray(value) && value.length === 0) ||\r\n      value === false \r\n    ) {\r\n      return;\r\n    }\r\n    cleaned[key] = value;\r\n  });\r\n  \r\n  return cleaned;\r\n};\r\n\r\nexport const encodeFilters = (filters) => {\r\n  try {\r\n    const cleanedFilters = cleanFilters(filters);\r\n    \r\n    if (Object.keys(cleanedFilters).length === 0) {\r\n      return '';\r\n    }\r\n    \r\n    const json = JSON.stringify(cleanedFilters);\r\n    return btoa(encodeURIComponent(json));\r\n  } catch (e) {\r\n    return '';\r\n  }\r\n};\r\n\r\nexport const decodeFilters = (encoded) => {\r\n  try {\r\n    const json = decodeURIComponent(atob(encoded));\r\n    return JSON.parse(json);\r\n  } catch (e) {\r\n    return {};\r\n  }\r\n};","import React, { useState, useMemo, useCallback, useEffect } from \"react\";\r\nimport { useQuery } from \"@tanstack/react-query\";\r\nimport { FilterPanel } from \"./FilterPanel\";\r\nimport { SearchHeader } from \"./FilterItem\";\r\nimport { applyFilters, updateSchemaWithDynamicOptions, decodeFilters, encodeFilters } from \"./FilterUtils\";\r\nimport { Loader2 } from \"lucide-react\";\r\n\r\nexport const DatasetFilter = ({\r\n  schema,\r\n  data = [],\r\n  queryKey,\r\n  queryFn,\r\n  dataTransform = (d) => d,\r\n  renderContent,\r\n  enableUrlSync = true,\r\n  queryOptions = {},\r\n  className = \"\"\r\n}) => {\r\n  const [filters, setFilters] = useState({});\r\n\r\n  const { data: fetchedData, isLoading, error } = useQuery({\r\n    queryKey: queryKey || ['dataset'],\r\n    queryFn: queryFn || (() => Promise.resolve({ data })),\r\n    enabled: !!queryFn,\r\n    ...queryOptions\r\n  });\r\n\r\n  const sourceData = queryFn ? (dataTransform(fetchedData) || []) : data;\r\n\r\n  const updatedSchema = useMemo(() => updateSchemaWithDynamicOptions(schema, sourceData), [schema, sourceData]);\r\n\r\n  const filteredData = useMemo(() => applyFilters(sourceData, filters, updatedSchema), [sourceData, filters, updatedSchema]);\r\n\r\n  const updateFilter = useCallback((key, value) => {\r\n    setFilters(prev => {\r\n      const newFilters = { ...prev };\r\n      if (value === undefined || value === null || value === \"\" || (Array.isArray(value) && value.length === 0) || value === false) {\r\n        delete newFilters[key];\r\n      } else {\r\n        newFilters[key] = value;\r\n      }\r\n      return newFilters;\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!enableUrlSync) return;\r\n    const params = new URLSearchParams(window.location.search);\r\n    const encoded = params.get(\"f\");\r\n    if (encoded) setFilters(decodeFilters(encoded));\r\n  }, [enableUrlSync]);\r\n\r\n  useEffect(() => {\r\n    if (!enableUrlSync) return;\r\n    const encoded = encodeFilters(filters);\r\n    if (!encoded) {\r\n      window.history.replaceState({}, \"\", window.location.pathname);\r\n      return;\r\n    }\r\n    const params = new URLSearchParams();\r\n    params.set(\"f\", encoded);\r\n    window.history.replaceState({}, \"\", `?${params.toString()}`);\r\n  }, [filters, enableUrlSync]);\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <Loader2 className=\"w-8 h-8 animate-spin text-primary-600 mx-auto mb-2\" />\r\n          <p className=\"text-gray-600\">Loading data...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center text-red-600\">\r\n          <p className=\"font-semibold mb-2\">Error loading data</p>\r\n          <p className=\"text-sm\">{error.message}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`flex min-h-screen bg-gray-50 ${className}`}>\r\n      <FilterPanel\r\n        schema={updatedSchema}\r\n        filters={filters}\r\n        onFilterChange={updateFilter}\r\n      />\r\n\r\n      <div className=\"flex-1 p-8\">\r\n        <div className=\"max-w-5xl mx-auto\">\r\n          <SearchHeader\r\n            schema={updatedSchema}\r\n            filters={filters}\r\n            onFilterChange={updateFilter}\r\n            onRemoveFilter={updateFilter}\r\n          />\r\n\r\n          {renderContent &&\r\n            renderContent({\r\n              filteredData,\r\n              totalData: sourceData,\r\n              filters,\r\n            })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};","import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\r\nimport { DatasetFilter as OriginalDatasetFilter } from \"./DatasetFilter\";\r\n\r\nconst defaultQueryClient = new QueryClient();\r\n\r\nexport const DatasetFilter = (props) => (\r\n  <QueryClientProvider client={defaultQueryClient}>\r\n    <OriginalDatasetFilter {...props} />\r\n  </QueryClientProvider>\r\n);\r\n"],"names":["FilterSection","label","isNested","children","defaultExpanded","isExpanded","setIsExpanded","useState","HeadingTag","headingClass","containerClass","_jsxs","className","onClick","_jsx","ChevronDown","CheckboxItem","checked","onChange","type","CheckboxGroupFilter","config","value","showAll","setShowAll","toggleOption","useCallback","option","newValue","includes","filter","v","length","undefined","options","visibleOptions","slice","map","RangeFilter","_config$ranges","toggleRange","ranges","range","CheckboxFilter","e","target","NestedGroupFilter","filters","onFilterChange","childKey","childConfig","childrenSchema","val","FilterBadges","schema","onRemove","badges","useMemo","result","extractBadges","schemaObj","Object","entries","forEach","key","push","Array","isArray","badge","X","SearchHeader","searchConfigEntry","find","_","c","searchKey","searchSchema","searchValue","Search","placeholder","newValues","FilterPanel","generalExpanded","setGeneralExpanded","React","standaloneCheckboxes","SlidersHorizontal","renderFilter","getNestedValue","obj","path","split","reduce","acc","part","updateSchemaWithDynamicOptions","data","dynamicOptions","extractDynamicOptions","flatSchema","optionsSet","Set","item","field","transform","add","String","from","sort","updatedSchema","encodeFilters","cleanedFilters","cleaned","cleanFilters","keys","json","JSON","stringify","btoa","encodeURIComponent","DatasetFilter","queryKey","queryFn","dataTransform","d","renderContent","enableUrlSync","queryOptions","setFilters","fetchedData","isLoading","error","useQuery","Promise","resolve","enabled","sourceData","filteredData","applyFilters","searchConfig","configType","toLowerCase","trim","searchTerm","fields","some","every","filterKey","filterValue","itemValue","itemArray","selected","normalizedItemArray","normalizedSelected","normalizedOptions","opt","numValue","Number","isNaN","r","min","max","itemStr","filterStr","updateFilter","prev","newFilters","useEffect","encoded","URLSearchParams","window","location","search","get","decodeURIComponent","atob","parse","decodeFilters","history","replaceState","pathname","params","set","toString","Loader2","message","onRemoveFilter","totalData","defaultQueryClient","QueryClient","props","QueryClientProvider","client","OriginalDatasetFilter"],"mappings":"gIAGO,MAAMA,EAAgBA,EAAGC,QAAOC,YAAW,EAAOC,WAAUC,mBAAkB,MACnF,MAAOC,EAAYC,GAAiBC,EAAAA,SAASH,GAEvCI,EAAaN,EAAW,KAAO,KAC/BO,EAAeP,EACjB,yCACA,uEAEEQ,EAAiBR,EAAW,GAAK,iCAEvC,OACES,EAAAA,KAAA,MAAA,CAAKC,UAAWF,EAAeP,UAC7BQ,EAAAA,KAAA,SAAA,CACEE,QAASA,IAAMP,GAAeD,GAC9BO,UAAU,oCAAmCT,SAAA,CAE7CW,EAAAA,IAACN,EAAU,CAACI,UAAWH,EAAaN,SAAEF,IACtCa,EAAAA,IAACC,cAAW,CAACH,UAAW,sEAAqEP,EAAa,aAAe,SAG1HA,GAAcS,EAAAA,IAAA,MAAA,CAAKF,UAAU,mBAAkBT,SAAEA,QClB3Ca,EAAeA,EAAGC,UAASC,WAAUjB,WAE9CU,EAAAA,KAAA,QAAA,CAAOC,UAAU,oDAAmDT,UAClEW,EAAAA,IAAA,QAAA,CACEK,KAAK,WACLF,QAASA,EACTC,SAAUA,EACVN,UAAU,wJAEZE,EAAAA,IAAA,OAAA,CAAMF,UAAU,kFAAiFT,SAC9FF,OAMImB,EAAsBA,EAAGC,SAAS,CAAA,EAAIC,QAAQ,GAAIJ,WAAUhB,YAAW,MAClF,MAAOqB,EAASC,GAAcjB,EAAAA,UAAS,GAEjCkB,EAAeC,EAAAA,YAAaC,IAChC,MAAMC,EAAWN,EAAMO,SAASF,GAAUL,EAAMQ,OAAOC,GAAKA,IAAMJ,GAAU,IAAIL,EAAOK,GACvFT,EAASU,EAASI,OAASJ,OAAWK,IACrC,CAACX,EAAOJ,IAEX,IAAKG,EAAOa,SAAqC,IAA1Bb,EAAOa,QAAQF,OAAc,OAAO,KAE3D,MACMG,EAAiBZ,EAAUF,EAAOa,QAAUb,EAAOa,QAAQE,MAAM,EADnD,GAGpB,OACEzB,EAAAA,KAACX,EAAa,CAACC,MAAOoB,EAAOpB,MAAOC,SAAUA,EAASC,SAAA,CACpDgC,EAAeE,IAAIV,GAClBb,EAAAA,IAACE,EAAY,CAEXf,MAAO0B,EACPV,SAASK,aAAK,EAALA,EAAOO,SAASF,MAAW,EACpCT,SAAUA,IAAMO,EAAaE,IAHxBA,IAORN,EAAOa,QAAQF,OAdA,GAedlB,EAAAA,IAAA,SAAA,CACED,QAASA,IAAMW,GAAYD,GAC3BX,UAAU,gGAA+FT,SAExGoB,EAAU,WAAa,gBASrBe,EAAcA,EAAGjB,SAAQC,QAAQ,GAAIJ,WAAUhB,YAAW,MAAY,IAAAqC,EACjF,MAAMC,EAAcd,EAAAA,YAAazB,IAC/B,MAAM2B,EAAWN,EAAMO,SAAS5B,GAASqB,EAAMQ,OAAOC,GAAKA,IAAM9B,GAAS,IAAIqB,EAAOrB,GACrFiB,EAASU,EAASI,OAASJ,OAAWK,IACrC,CAACX,EAAOJ,IAEX,OAAkB,QAAdqB,EAAClB,EAAOoB,cAAM,IAAAF,GAAbA,EAAeP,OAGlBlB,EAAAA,IAACd,EAAa,CAACC,MAAOoB,EAAOpB,MAAOC,SAAUA,EAASC,SACpDkB,EAAOoB,OAAOJ,IAAIK,GACjB5B,EAAAA,IAACE,EAAY,CAEXf,MAAOyC,EAAMzC,MACbgB,SAASK,aAAK,EAALA,EAAOO,SAASa,EAAMzC,UAAU,EACzCiB,SAAUA,IAAMsB,EAAYE,EAAMzC,QAH7ByC,EAAMzC,UANgB,MAiBxB0C,EAAiBA,EAAGtB,SAAQC,SAAQ,EAAOJ,cAEpDJ,EAAAA,IAAA,MAAA,CAAAX,SACEW,EAAAA,IAACE,EAAY,CACXC,UAAWK,EACXJ,SAAW0B,GAAM1B,IAAS0B,EAAEC,OAAO5B,cAAiBgB,GACpDhC,MAAOoB,EAAOpB,UAOT6C,EAAoBA,EAAGzB,SAAQ0B,UAASC,iBAAgB5C,mBAAkB,KAChFiB,EAAOlB,UAAuC,IAA3BkB,EAAOlB,SAAS6B,OAGtClB,EAAAA,IAACd,EAAa,CAACC,MAAOoB,EAAOpB,MAAOG,gBAAiBA,EAAgBD,SAClEkB,EAAOlB,SAASkC,IAAIY,IACnB,MAAMC,EAAc7B,EAAO8B,eAAeF,GAC1C,OAAKC,EAEoB,mBAArBA,EAAY/B,KAEZL,EAAAA,IAACM,EAAmB,CAElBC,OAAQ6B,EACR5B,MAAOyB,EAAQE,GACf/B,SAAWkC,GAAQJ,EAAeC,EAAUG,GAC5ClD,UAAU,GAJL+C,GASc,UAArBC,EAAY/B,KAEZL,EAAAA,IAACwB,EAAW,CAEVjB,OAAQ6B,EACR5B,MAAOyB,EAAQE,GACf/B,SAAWkC,GAAQJ,EAAeC,EAAUG,GAC5ClD,UAAU,GAJL+C,GASJ,KA1BkB,SAN8B,KAsClDI,EAAeA,EAAGC,SAAQP,UAASQ,eAC9C,MAAMC,EAASC,EAAAA,QAAQ,KACrB,MAAMC,EAAS,GAETC,EAAiBC,IACrBC,OAAOC,QAAQF,GAAWG,QAAQ,EAAEC,EAAK3C,MACvC,GAAoB,UAAhBA,EAAOF,MAAoBE,EAAO8B,eAEpC,YADAQ,EAActC,EAAO8B,gBAIvB,MAAM7B,EAAQyB,EAAQiB,GACjB1C,IAEe,WAAhBD,EAAOF,KACTuC,EAAOO,KAAK,CAAED,MAAK/D,MAAOqB,EAAOH,KAAM,WACd,aAAhBE,EAAOF,OAAiC,IAAVG,EACvCoC,EAAOO,KAAK,CAAED,MAAK/D,MAAOoB,EAAOpB,MAAOkB,KAAM,aACrC+C,MAAMC,QAAQ7C,IAAUA,EAAMU,OAAS,GAChDV,EAAMyC,QAAQX,GAAOM,EAAOO,KAAK,CAAED,MAAK/D,MAAOmD,EAAKjC,KAAM,QAASG,MAAO8B,SAMhF,OADAO,EAAcL,GACPI,GACN,CAACJ,EAAQP,IAEZ,OAAKS,EAAOxB,OAGVlB,EAAAA,IAAA,MAAA,CAAKF,UAAU,4BAA2BT,SACvCqD,EAAOnB,IAAI+B,GACVzD,EAAAA,KAAA,OAAA,CAAgDC,UAAU,4FAA2FT,UACnJW,EAAAA,IAAA,OAAA,CAAAX,SAAOiE,EAAMnE,QACba,EAAAA,IAAA,SAAA,CAAQD,QAASA,IAAM0C,EAASa,GAAQxD,UAAU,8DAA6DT,SAC7GW,EAAAA,IAACuD,IAAC,CAACzD,UAAU,oBAHN,GAAGwD,EAAMJ,OAAOI,EAAM9C,OAAS,SALrB,MAiBhBgD,EAAeA,EAAGhB,SAAQP,UAASC,qBAC9C,MAAMuB,EAAoBV,OAAOC,QAAQR,GAAQkB,KAAK,EAAEC,EAAGC,KAAkB,WAAXA,EAAEvD,MACpE,IAAKoD,EAAmB,OAAO,KAE/B,MAAOI,EAAWC,GAAgBL,EAC5BM,EAAc9B,EAAQ4B,IAAc,GAY1C,OACEhE,EAAAA,KAAA,MAAA,CAAKC,UAAU,OAAMT,UACnBQ,EAAAA,KAAA,MAAA,CAAKC,UAAU,WAAUT,SAAA,CACvBW,EAAAA,IAACgE,SAAM,CAAClE,UAAU,mEAClBE,EAAAA,IAAA,QAAA,CACEK,KAAK,OACL4D,YAAaH,EAAaG,YAC1BzD,MAAOuD,EACP3D,SAAW0B,GAAMI,EAAe2B,EAAW/B,EAAEC,OAAOvB,OACpDV,UAAU,wIAEXiE,GACC/D,EAAAA,IAAA,SAAA,CAAQD,QAASA,IAAMmC,EAAe2B,EAAW,IAAK/D,UAAU,4CAA2CT,SACzGW,EAAAA,IAACuD,IAAC,CAACzD,UAAU,mDAKnBE,EAAAA,IAACuC,EAAY,CAACC,OAAQA,EAAQP,QAASA,EAASQ,SA5B/Ba,IACnB,GAAmB,WAAfA,EAAMjD,KAAmB6B,EAAeoB,EAAMJ,IAAK,SAClD,GAAmB,UAAfI,EAAMjD,KAAkB,CAC/B,MAAM6D,GAAajC,EAAQqB,EAAMJ,MAAQ,IAAIlC,OAAOC,GAAKA,IAAMqC,EAAM9C,OACrE0B,EAAeoB,EAAMJ,IAAKgB,EAAUhD,OAASgD,OAAY/C,EAC3D,KAA0B,aAAfmC,EAAMjD,MACf6B,EAAeoB,EAAMJ,SAAK/B,UC5LnBgD,EAAcA,EAAG3B,SAAQP,UAASC,qBAC7C,MAAOkC,EAAiBC,GAAsBC,EAAM7E,UAAS,GA0CvD8E,EAAuBxB,OAAOC,QAAQR,GAAQxB,OAClD,EAAC,CAAGT,KAA4B,aAAhBA,EAAOF,MAGzB,OACER,EAAAA,KAAA,MAAA,CAAKC,UAAU,iGAAgGT,UAE7GQ,EAAAA,KAAA,MAAA,CAAKC,UAAU,+BAA8BT,SAAA,CAC3CW,EAAAA,IAACwE,oBAAiB,CAAC1E,UAAU,6BAC7BE,EAAAA,IAAA,KAAA,CAAIF,UAAU,qDAAoDT,SAAC,eAIpEkF,EAAqBrD,OAAS,GAC7BrB,EAAAA,KAAA,MAAA,CAAKC,UAAU,qCAAoCT,UACjDQ,EAAAA,KAAA,SAAA,CACEE,QAASA,IAAMsE,GAAoBD,GACnCtE,UAAU,iDAAgDT,UAE1DW,EAAAA,IAAA,KAAA,CAAIF,UAAU,kEAAiET,SAAC,YAGhFW,EAAAA,IAACC,cAAW,CACVH,UAAW,sEAAqEsE,EAAkB,aAAe,SAIpHA,GACCpE,EAAAA,IAAA,MAAA,CAAKF,UAAU,mBAAkBT,SAC9BkF,EAAqBhD,IAAI,EAAE2B,EAAK3C,KAC/BP,EAAAA,IAAC6B,EAAc,CAEbtB,OAAQA,EACRC,MAAOyB,EAAQiB,GACf9C,SAAWkC,GAAQJ,EAAegB,EAAKZ,IAHlCY,SAYhBH,OAAOC,QAAQR,GAAQjB,IAAI,EAAE2B,EAAK3C,KAnFlBkE,EAACvB,EAAK3C,IACL,WAAhBA,EAAOF,KAA0B,KAEjB,UAAhBE,EAAOF,KAEPL,EAAAA,IAACgC,EAAiB,CAEhBzB,OAAQA,EACR0B,QAASA,EACTC,eAAgBA,GAHXgB,GAQS,mBAAhB3C,EAAOF,KAEPL,EAAAA,IAACM,EAAmB,CAElBC,OAAQA,EACRC,MAAOyB,EAAQiB,GACf9C,SAAWI,GAAU0B,EAAegB,EAAK1C,IAHpC0C,GAQS,UAAhB3C,EAAOF,KAEPL,EAAAA,IAACwB,EAAW,CAEVjB,OAAQA,EACRC,MAAOyB,EAAQiB,GACf9C,SAAWI,GAAU0B,EAAegB,EAAK1C,IAHpC0C,GAQJ,KA+C0CuB,CAAavB,EAAK3C,QC1F1DmE,EAAiBA,CAACC,EAAKC,IAC7BA,GAASD,EACPC,EAAKC,MAAM,KAAKC,OAAO,CAACC,EAAKC,IAC9BD,QAA0C,KACvCA,EAAIC,GACVL,GAJuB,KAuLfM,EAAiCA,CAACzC,EAAQ0C,KACrD,MAAMC,EA7C6BC,EAACF,EAAM1C,KAC1C,MAAM2C,EAAiB,CAAA,EAEjBE,EAAa,CAAA,EAEIvC,MAoCvB,OApCuBA,EAYTN,EAXZO,OAAOC,QAAQF,GAAWG,QAAQ,EAAEC,EAAK3C,MACnB,UAAhBA,EAAOF,MAAoBE,EAAO8B,eACpCU,OAAOC,QAAQzC,EAAO8B,gBAAgBY,QAAQ,EAAEd,EAAUC,MACxDiD,EAAWlD,GAAYC,IAGzBiD,EAAWnC,GAAO3C,IAOxBwC,OAAOC,QAAQqC,GAAYpC,QAAQ,EAAEC,EAAK3C,MACxC,GAAIA,EAAOa,SAAWb,EAAOa,QAAQF,OAAS,EAAG,OACjD,IAAK,CAAC,iBAAkB,SAAU,YAAYH,SAASR,EAAOF,MAAO,OAErE,MAAMiF,EAAa,IAAIC,IAEvBL,EAAKjC,QAAQuC,IACX,IAAIhF,EAAQkE,EAAec,EAAMjF,EAAOkF,OACpClF,EAAOmF,WAAPnF,MAAoBC,IACtBA,EAAQD,EAAOmF,UAAUlF,IAGvBD,EAAO8C,SAAWD,MAAMC,QAAQ7C,GAClCA,EAAMyC,QAAQhC,GAAW,OAANA,GAAcqE,EAAWK,IAAIC,OAAO3E,KAC9CT,SACT8E,EAAWK,IAAIC,OAAOpF,MAI1B2E,EAAejC,GAAOE,MAAMyC,KAAKP,GAAYQ,SAGxCX,GAIgBC,CAAsBF,EAAM1C,GAC7CuD,EAAgB,CAAA,EAkBtB,OAhBAhD,OAAOC,QAAQR,GAAQS,QAAQ,EAAEC,EAAK3C,MACpCwF,EAAc7C,GAAO,IAAK3C,GAEN,UAAhBA,EAAOF,MAAoBE,EAAO8B,gBACpC0D,EAAc7C,GAAKb,eAAiB,CAAA,EACpCU,OAAOC,QAAQzC,EAAO8B,gBAAgBY,QAAQ,EAAEd,EAAUC,MACxD2D,EAAc7C,GAAKb,eAAeF,GAAY,IAAKC,GAC/C+C,EAAehD,IAAagD,EAAehD,GAAUjB,OAAS,IAChE6E,EAAc7C,GAAKb,eAAeF,GAAUf,QAAU+D,EAAehD,OAGhEgD,EAAejC,IAAQiC,EAAejC,GAAKhC,OAAS,IAC7D6E,EAAc7C,GAAK9B,QAAU+D,EAAejC,MAIzC6C,GAsBIC,EAAiB/D,IAC5B,IACE,MAAMgE,EArBmBhE,KAC3B,MAAMiE,EAAU,CAAA,EAehB,OAbAnD,OAAOC,QAAQf,GAASgB,QAAQ,EAAEC,EAAK1C,MAEnCA,SAEU,KAAVA,GACC4C,MAAMC,QAAQ7C,IAA2B,IAAjBA,EAAMU,SACrB,IAAVV,IAIF0F,EAAQhD,GAAO1C,KAGV0F,GAKkBC,CAAalE,GAEpC,GAA2C,IAAvCc,OAAOqD,KAAKH,GAAgB/E,OAC9B,MAAO,GAGT,MAAMmF,EAAOC,KAAKC,UAAUN,GAC5B,OAAOO,KAAKC,mBAAmBJ,GACjC,CAAE,MAAOvE,GACP,MAAO,EACT,GCvOW4E,EAAgBA,EAC3BlE,SACA0C,OAAO,GACPyB,WACAC,UACAC,gBAAiBC,GAAMA,EACvBC,gBACAC,iBAAgB,EAChBC,eAAe,CAAA,EACfnH,YAAY,OAEZ,MAAOmC,EAASiF,GAAczH,EAAAA,SAAS,CAAA,IAE/ByF,KAAMiC,EAAWC,UAAEA,EAASC,MAAEA,GAAUC,WAAS,CACvDX,SAAUA,GAAY,CAAC,WACvBC,QAASA,GAAO,KAAWW,QAAQC,QAAQ,CAAEtC,UAC7CuC,UAAWb,KACRK,IAGCS,EAAad,EAAWC,EAAcM,IAAgB,GAAMjC,EAE5Da,EAAgBpD,UAAQ,IAAMsC,EAA+BzC,EAAQkF,GAAa,CAAClF,EAAQkF,IAE3FC,EAAehF,EAAAA,QAAQ,IDtBHiF,EAAC1C,EAAMjD,EAASO,KAC1C,IAAK0C,IAAS9B,MAAMC,QAAQ6B,GAAO,MAAO,GAC1C,IAAKjD,GAA2C,IAAhCc,OAAOqD,KAAKnE,GAASf,OAAc,OAAOgE,EAE1D,MAAMG,EAAa,CAAA,EACnB,IAAIwC,EAAe,KACfhE,EAAY,KAEOf,MAyBvB,OAzBuBA,EAuBTN,IApBZO,OAAOC,QAAQF,GAAWG,QAAQ,EAAEC,EAAK3C,MACvC,IAAKA,EAAQ,OAGb,MAAMuH,EAAalC,OAAOrF,EAAOF,MAAM0H,cAAcC,OAElC,UAAfF,GAA0BvH,EAAO8B,eACnCU,OAAOC,QAAQzC,EAAO8B,gBAAgBY,QAAQ,EAAEd,EAAUC,MACxDiD,EAAWlD,GAAYC,IAED,WAAf0F,GAETD,EAAetH,EACfsD,EAAYX,GAEZmC,EAAWnC,GAAO3C,IAOjB2E,EAAKlE,OAAOwE,IAEjB,GAAIqC,GAAgBhE,GAAa5B,EAAQ4B,GAAY,CACnD,MAAMoE,EAAahG,EAAQ4B,GAC3B,GAAIoE,GAAcA,EAAWD,UACZ5E,MAAMC,QAAQwE,EAAaK,QAAUL,EAAaK,OAAS,CAACL,EAAapC,QAC3D0C,KAAK1C,IAChC,MAAMjF,EAAQkE,EAAec,EAAMC,GAGnC,OAAIrC,MAAMC,QAAQ7C,GACTA,EAAM2H,KAAKlH,GAChB2E,OAAO3E,GAAK,IAAI8G,cAAchH,SAASkH,EAAWF,gBAK/CnC,OAAOpF,GAAS,IAAIuH,cAAchH,SAASkH,EAAWF,iBAG3C,OAAO,CAE/B,CAGA,OAAOhF,OAAOC,QAAQf,GAASmG,MAAM,EAAEC,EAAWC,MAEhD,GAAIzE,GAAawE,IAAcxE,EAAW,OAAO,EAEjD,IAAKyE,GAAgBlF,MAAMC,QAAQiF,IAAuC,IAAvBA,EAAYpH,OAAe,OAAO,EAErF,MAAMX,EAAS8E,EAAWgD,GAC1B,IAAK9H,EAAQ,OAAO,EAEpB,IAAIgI,EAAY7D,EAAec,EAAMjF,EAAOkF,OAE5C,OAAQlF,EAAOF,MACb,IAAK,iBAAkB,CACjBE,EAAOmF,WAAPnF,MAAoBgI,IACtBA,EAAYhI,EAAOmF,UAAU6C,IAG/B,MAAMC,EAAYpF,MAAMC,QAAQkF,GAAaA,EAAY,CAACA,GACpDE,EAAWrF,MAAMC,QAAQiF,GAAeA,EAAc,CAACA,GAEvDI,EAAsBF,EAAUjH,IAAIe,GACxCA,EAAMsD,OAAOtD,GAAKyF,cAAgBzF,GAE9BqG,EAAqBF,EAASlH,IAAIe,GACtCA,EAAMsD,OAAOtD,GAAKyF,cAAgBzF,GAGpC,GAAIqG,EAAmB5H,SAAS,UAAYR,EAAOa,QAAS,CAC1D,MAAMwH,EAAoBrI,EAAOa,QAAQG,IAAIsH,GAAOA,EAAId,eAIxD,GAHsBW,EAAoBP,KACxC7F,GAAOA,IAAQsG,EAAkB7H,SAASuB,IAEzB,OAAO,CAC5B,CAEA,OAAOqG,EAAmBR,KAAK7F,GAAOoG,EAAoB3H,SAASuB,GACrE,CAEA,IAAK,QAAS,CACZ,MAAMwG,EAAWC,OAAOR,GACxB,OAAIS,MAAMF,IAANE,MAAmBT,GAEhBD,EAAYH,KAAKhJ,IACtB,MAAMyC,EAAQrB,EAAOoB,OAAO+B,KAAKuF,GAAKA,EAAE9J,QAAUA,GAClD,QAAOyC,GAAQkH,GAAYlH,EAAMsH,KAAOJ,GAAYlH,EAAMuH,KAE9D,CAEA,IAAK,WACH,OAAOb,KAAgBC,EAGzB,IAAK,SAAU,CACb,IAAKA,EAAW,OAAO,EAEvB,MAAMa,EAAUxD,OAAO2C,GAAWR,cAC5BsB,EAAYzD,OAAO0C,GAAaP,cAEtC,MAAkB,UAAdsB,GAAyB9I,EAAOa,SACRb,EAAOa,QAAQG,IAAIsH,GAAOA,EAAId,eAC9BhH,SAASqI,GAG9BA,IAAYC,CACrB,CAEA,QACE,OAAO,QCvGoBzB,CAAaF,EAAYzF,EAAS8D,GAAgB,CAAC2B,EAAYzF,EAAS8D,IAErGuD,EAAe1I,EAAAA,YAAY,CAACsC,EAAK1C,KACrC0G,EAAWqC,IACT,MAAMC,EAAa,IAAKD,GAMxB,OALI/I,SAAmD,KAAVA,GAAiB4C,MAAMC,QAAQ7C,IAA2B,IAAjBA,EAAMU,SAA2B,IAAVV,SACpGgJ,EAAWtG,GAElBsG,EAAWtG,GAAO1C,EAEbgJ,KAER,IAoBH,OAlBAC,EAAAA,UAAU,KACR,IAAKzC,EAAe,OACpB,MACM0C,EADS,IAAIC,gBAAgBC,OAAOC,SAASC,QAC5BC,IAAI,KACvBL,GAASxC,EDgMawC,KAC5B,IACE,MAAMrD,EAAO2D,mBAAmBC,KAAKP,IACrC,OAAOpD,KAAK4D,MAAM7D,EACpB,CAAE,MAAOvE,GACP,MAAO,CAAA,CACT,GCtM0BqI,CAAcT,KACrC,CAAC1C,IAEJyC,EAAAA,UAAU,KACR,IAAKzC,EAAe,OACpB,MAAM0C,EAAU1D,EAAc/D,GAC9B,IAAKyH,EAEH,YADAE,OAAOQ,QAAQC,aAAa,CAAA,EAAI,GAAIT,OAAOC,SAASS,UAGtD,MAAMC,EAAS,IAAIZ,gBACnBY,EAAOC,IAAI,IAAKd,GAChBE,OAAOQ,QAAQC,aAAa,GAAI,GAAI,IAAIE,EAAOE,eAC9C,CAACxI,EAAS+E,IACTI,EAEApH,EAAAA,IAAA,MAAA,CAAKF,UAAU,gDAA+CT,SAC5DQ,EAAAA,KAAA,MAAA,CAAKC,UAAU,cAAaT,SAAA,CAC1BW,EAAAA,IAAC0K,UAAO,CAAC5K,UAAU,uDACnBE,EAAAA,IAAA,IAAA,CAAGF,UAAU,gBAAeT,SAAC,yBAMjCgI,EAEArH,EAAAA,IAAA,MAAA,CAAKF,UAAU,gDAA+CT,SAC5DQ,EAAAA,KAAA,MAAA,CAAKC,UAAU,2BAA0BT,UACvCW,EAAAA,IAAA,IAAA,CAAGF,UAAU,qBAAoBT,SAAC,uBAClCW,EAAAA,IAAA,IAAA,CAAGF,UAAU,UAAST,SAAEgI,EAAMsD,eAOpC9K,EAAAA,KAAA,MAAA,CAAKC,UAAW,gCAAgCA,IAAYT,SAAA,CAC1DW,EAAAA,IAACmE,EAAW,CACV3B,OAAQuD,EACR9D,QAASA,EACTC,eAAgBoH,IAGlBtJ,EAAAA,IAAA,MAAA,CAAKF,UAAU,aAAYT,SACzBQ,EAAAA,KAAA,MAAA,CAAKC,UAAU,oBAAmBT,SAAA,CAChCW,EAAAA,IAACwD,EAAY,CACXhB,OAAQuD,EACR9D,QAASA,EACTC,eAAgBoH,EAChBsB,eAAgBtB,IAGjBvC,GACCA,EAAc,CACZY,eACAkD,UAAWnD,EACXzF,qBCvGR6I,EAAqB,IAAIC,EAAAA,kCAEDC,GAC5BhL,EAAAA,IAACiL,sBAAmB,CAACC,OAAQJ,EAAmBzL,SAC9CW,EAAAA,IAACmL,EAAqB,IAAKH"}